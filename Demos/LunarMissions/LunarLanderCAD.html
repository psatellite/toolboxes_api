<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>Generate lunar lander CAD model</title>
<meta name="generator" content="MATLAB 24.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-01-22">
<meta name="DC.source" content="LunarLanderCAD.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>Generate lunar lander CAD model</h1>
<!--introduction-->
<p>Generate a CAD model of a lunary lander. Creates power and mass reports of the model and exports it to OBJ. Loads RCS.mat for thruster data.</p>
<p>Components in the model:</p>
<pre>GN&amp;C
----
1 IMU
6 Sun sensors
1 Star camera
1 Navigation camera</pre>
<pre>Communications
--------------
2 Omni antenna
1 High gain antenna</pre>
<pre>Power
-----
1 LiOn battery
2 Solar arrays</pre>
<pre>Data processing
---------------
1 RAD 5545 processor (cPCI)
1 Interface board   (cPCI)
1 Mass memory board (cPCI)
1 Command receiver  (cPCI)
1 GPS receiver      (cPCI)</pre>
<pre>Structure
---------
Composite frame
Composite panels</pre>
<pre>See also BuildCADModel, CreateReport, ExportOBJ, DrawCAD
------------------------------------------------------------------------</pre>
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#2">Multibody switch</a>
</li>
<li>
<a href="#3">Constants</a>
</li>
<li>
<a href="#4">Mission date</a>
</li>
<li>
<a href="#5">Mission information</a>
</li>
<li>
<a href="#6">Spacecraft hardware parameters</a>
</li>
<li>
<a href="#7">Initialize BuildCADModel and create the Core body</a>
</li>
<li>
<a href="#8">Components</a>
</li>
<li>
<a href="#9">Bus Frame</a>
</li>
<li>
<a href="#10">Panels</a>
</li>
<li>
<a href="#11">Sun sensors</a>
</li>
<li>
<a href="#12">Add subsystems</a>
</li>
<li>
<a href="#13">Update the mass properties to produce the tables</a>
</li>
<li>
<a href="#14">Export to obj</a>
</li>
</ul>
</div>
<pre class="codeinput">
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">%   Copyright (c) 2014 Princeton Satellite Systems, Inc.</span>
<span class="comment">%   All rights reserved.</span>
<span class="comment">%--------------------------------------------------------------------------</span>
</pre>
<h2 id="2">Multibody switch</h2>
<pre class="codeinput">
<span class="comment">%-----------------</span>
multiBody = false;
</pre>
<h2 id="3">Constants</h2>
<pre class="codeinput">
<span class="comment">%------------------</span>
rhoCarbonFiber  = 1600;
rhoAluminum     = 2700;
rhoGlass        = 2400;
rhoSteel        = 8000;
rhoTungsten     = 15630;
inToM           = 0.0254;
solarFlux       = 1367;
rhoSolarPanel   = 10.3e3/36.4; <span class="comment">% Dawn spacecraft</span>
lToM3           = 0.001; <span class="comment">% Liters to cubic meters</span>
</pre>
<h2 id="4">Mission date</h2>
<pre class="codeinput">
<span class="comment">%--------------</span>
date            = [2015 5 7 0 0 0];
jD              = Date2JD(date);
</pre>
<h2 id="5">Mission information</h2>
<pre class="codeinput">
<span class="comment">%---------------------</span>
hOrbit          = 450;
sma             = hOrbit + 6378.165;
inc             = 80*pi/180;
omega           = 5*pi/180; <span class="comment">% Angular rate</span>
omegaDot        = omega/5;
tRWA            = 0.01;
</pre>
<h2 id="6">Spacecraft hardware parameters</h2>
<pre class="codeinput">
<span class="comment">%--------------------------------</span>

<span class="comment">% Thrusters</span>
<span class="comment">%----------</span>
<span class="comment">% LunarRCS.mat is a file with data fields rThruster and uThruster, which are</span>
<span class="comment">% used in the thruster components</span>
load <span class="string">LunarRCS.mat</span>
lThruster     = [0.1   0.026 0.026 0.026 0.026 0.026 0.026];
rThrusterElec	= [0.05   0.01  0.01  0.01  0.01  0.01  0.01];
lThrusterElec = [0.1   0.15  0.15  0.15  0.15  0.15  0.15];
massThruster  = [2.00  0.34  0.34  0.34  0.34  0.34  0.34];
dConeThruster = [0.1   0.02  0.02  0.02  0.02  0.02  0.02];

<span class="comment">% Bus</span>
<span class="comment">%----</span>
u                 = 0.1;
zBox              = 4*u;
xBox              = 6.8*u;
yBox              = 6.8*u;
panelThickness    = 0.004;

<span class="comment">% Inertia</span>
<span class="comment">%--------</span>
inertia   = [1.1565   -0.0074    0.0561;<span class="keyword">...</span>
            -0.0074    1.0380    0.02281;<span class="keyword">...</span>
             0.0561    0.0228    0.7354];

<span class="comment">% Fuel tank</span>
<span class="comment">%----------</span>
mFuelLRO	              = 654;
rhoHPGP                 = mFuelLRO/0.56;
fTank                   = 49/mFuelLRO;
massFuel                = 67.63;
volFuel                 = massFuel/rhoHPGP/2;
rTank                   = (volFuel/(4*pi/3))^(1/3);
f                       = 0.8;
rATank                  = [f*rTank*[1 -1;1 -1];zBox/2 zBox/2];

<span class="comment">% Star camera</span>
<span class="comment">%------------</span>
cameraAperture          = 12.5;
cameraFocalLength       = 25.0;
cameraLengthSunShade    = 35.0;
cameraApertureSunShade	= 25.0;
massCamera              = 0.25;
rCamera                 = 0.4*[xBox -xBox;-yBox yBox;zBox zBox];
uC                      = [0;0;1];
v1                      = Unit([1;-1;-1]);
v2                      = Unit([-1;1;-1]);
b1                      = Q2Mat(U2Q(uC,v1));
b2                      = Q2Mat(U2Q(uC,v2));
bCamera                 = {b1 b2};

<span class="comment">% High Gain Antenna</span>
<span class="comment">%------------------</span>
aBCHGA            = [0.8*xBox 0.8*xBox 0.2*xBox];
powerHGA          = 20;

<span class="comment">% Omni antennas</span>
<span class="comment">%--------------</span>
powerOmni         = 2;
xOmni             = [xBox xBox; yBox -yBox; 0 0]/2;
rOmni             = 0.002;
c                 = Constant(<span class="string">'speed of light'</span>)*1000; <span class="comment">% m/s</span>
fComm             = 2e9; <span class="comment">% sband</span>
lOmni             = 0.5*c/fComm;
massOmni          = lOmni*pi*rOmni^2*rhoAluminum;
bOmni             = {[1 0 0;0 0 1;0 -1 0] [1 0 0;0 0 -1;0 1 0]};

<span class="comment">% IMU LN-200S</span>
<span class="comment">%------------</span>
radiusIMU         = 0.0889/2;
hIMU              = 0.0851;
massIMU           = 0.748;
dIMU.manufacturer = <span class="string">'Northrop Grumman'</span>;
dIMU.name         = <span class="string">'LN-200S'</span>;
powerIMU          = 12;

<span class="comment">% Sun Sensors</span>
<span class="comment">%-------------</span>
massSunSensor     = 0.035;
xSunSensor        = 0.06;
ySunSensor        = 0.03;
zSunSensor        = 0.012;
bSunSensor        = [1 -1 2 -2 3 -3];
powerSunSensor    = 0.6;

<span class="comment">% Processing boards - 3U CompactPCI boards</span>
<span class="comment">%-----------------------------------------</span>
nBoards           = 5;
powerBoard        = 12;
xChassis          = 0.16 + 0.02;
yChassis          = 0.1 + 0.02;
zChassis          = 0.02*nBoards + 0.02;
massChassis       = 1;

<span class="comment">% Solar arrays</span>
<span class="comment">%-------------</span>
massSAD                 = 0.2;
solarPanelThickness     = 0.004;
strutLength             = yBox/2;
nPanels                 = 2;
panelLength             = zBox;
panelWidth              = xBox;
massSolarPanel          = panelLength*panelWidth*rhoSolarPanel;
solarPanelEff           = 0.295;
zSolarWing              = zBox/2;
arrayMassFront          = 0.5*solarPanelThickness*panelLength*panelWidth*nPanels*rhoGlass;
arrayMassBack           = 0.5*solarPanelThickness*panelLength*panelWidth*nPanels*rhoCarbonFiber;
massStrut               = 0.1;
yPanel                  = yBox/6;

bX                      = [ 1 0 0;0 0 -1;0 1  0]';
bY                      = [-1 0 0;0 1  0;0 0 -1];

<span class="comment">% Battery</span>
<span class="comment">%--------</span>
power                     = 2*solarPanelEff*solarFlux*nPanels*panelLength*panelWidth;
powerNight                = 5;
massBattery               = powerNight*24*15/135; <span class="comment">% Saft batteries</span>
volBattery                = powerNight*24*15/250;
wBattery                  = (2*volBattery*lToM3)^(1/3); <span class="comment">% One length is half the others</span>
</pre>
<h2 id="7">Initialize BuildCADModel and create the Core body</h2>
<pre class="codeinput">
<span class="comment">%---------------------------------------------------</span>
BuildCADModel( <span class="string">'initialize'</span> );
BuildCADModel( <span class="string">'set name'</span> , <span class="string">'LunarLander'</span> );
BuildCADModel( <span class="string">'set units'</span>, <span class="string">'mks'</span> );

<span class="comment">% Core</span>
<span class="comment">%-----</span>
m = CreateBody(<span class="string">'make'</span>,<span class="string">'name'</span>,<span class="string">'Core'</span>);
BuildCADModel(<span class="string">'add body'</span>, m );

<span class="keyword">if</span>( multiBody )
  rHinge = [0;0;panelWidth/2];
<span class="keyword">else</span>
  rHinge = [0;0;0];
<span class="keyword">end</span>
m = CreateBody(<span class="string">'make'</span>,<span class="string">'name'</span>,<span class="string">'SolarWing'</span>,<span class="string">'rHinge'</span>,rHinge,<span class="string">'previousBody'</span>,1);
BuildCADModel(<span class="string">'add body'</span>, m );

<span class="keyword">if</span>( ~multiBody )
  zPanel = zBox+panelWidth/2;
  zStrut  = zBox;
<span class="keyword">end</span>

<span class="comment">% This creates the connections between the bodies</span>
<span class="comment">%------------------------------------------------</span>
BuildCADModel( <span class="string">'compute paths'</span> );
</pre>
<img vspace="5" hspace="5" src="LunarLanderCAD_01.png" alt=""> <h2 id="8">Components</h2>
<pre class="codeinput">
<span class="comment">% Solar Array 1</span>
<span class="comment">%---------------</span>
m = CreateComponent( <span class="string">'make'</span>, <span class="string">'box'</span>, <span class="string">'x'</span>,panelWidth, <span class="string">'y'</span>,nPanels*panelLength, <span class="string">'z'</span>,solarPanelThickness,<span class="keyword">...</span>
                     <span class="string">'faceColor'</span>, <span class="string">'solar cell'</span>, <span class="string">'rA'</span>, [0;yPanel+panelLength;zPanel], <span class="string">'mass'</span>, massSolarPanel,<span class="keyword">...</span>
                     <span class="string">'name'</span>,<span class="string">'Solar Array +Y'</span>, <span class="string">'body'</span>, 2,<span class="keyword">...</span>
                     <span class="string">'inside'</span>, 0, <span class="string">'power'</span>, -power/2 );

BuildCADModel( <span class="string">'add component'</span>, m );

<span class="comment">% Solar Array 2</span>
<span class="comment">%---------------</span>

m = CreateComponent( <span class="string">'make'</span>, <span class="string">'box'</span>, <span class="string">'x'</span>,panelWidth, <span class="string">'y'</span>,nPanels*panelLength, <span class="string">'z'</span>,solarPanelThickness,<span class="keyword">...</span>
                     <span class="string">'faceColor'</span>, <span class="string">'solar cell'</span>, <span class="string">'rA'</span>, [0;-yPanel-panelLength;zPanel], <span class="string">'mass'</span>, massSolarPanel,<span class="keyword">...</span>
                     <span class="string">'name'</span>,<span class="string">'Solar Array -Y'</span>, <span class="string">'body'</span>, 2,<span class="keyword">...</span>
                     <span class="string">'inside'</span>, 0, <span class="string">'power'</span>, -power/2 );

BuildCADModel( <span class="string">'add component'</span>, m );

<span class="comment">% Horizontal motor</span>
<span class="comment">%-----------------</span>
m = CreateComponent( <span class="string">'make'</span>, <span class="string">'cylinder'</span>, <span class="string">'rUpper'</span>, 0.02, <span class="string">'rLower'</span>, 0.02, <span class="string">'h'</span>, 2*yPanel, <span class="string">'n'</span>, 24, <span class="string">'rA'</span>,[0;-yPanel;zPanel],<span class="keyword">...</span>
                         <span class="string">'name'</span>, <span class="string">'Motor'</span>, <span class="string">'body'</span>, 2, <span class="string">'mass'</span>, massStrut,<span class="string">'power'</span>,0,<span class="string">'b'</span>,[1 0 0;0 0 1;0 -1 0],<span class="keyword">...</span>
                         <span class="string">'faceColor'</span>, [0 0 0], <span class="string">'inside'</span>, 1);
BuildCADModel( <span class="string">'add component'</span>, m );

<span class="comment">% Vertical strut</span>
<span class="comment">%---------------</span>
m = CreateComponent( <span class="string">'make'</span>, <span class="string">'cylinder'</span>, <span class="string">'rUpper'</span>, 0.01, <span class="string">'rLower'</span>, 0.01, <span class="string">'h'</span>, panelWidth/2, <span class="string">'n'</span>, 24, <span class="string">'rA'</span>,[0;0;zStrut],<span class="keyword">...</span>
                         <span class="string">'name'</span>, <span class="string">'Motor'</span>, <span class="string">'body'</span>, 1, <span class="string">'mass'</span>, massStrut,<span class="string">'power'</span>,0, <span class="keyword">...</span>
                         <span class="string">'faceColor'</span>, [0 0 0], <span class="string">'inside'</span>, 1);
BuildCADModel( <span class="string">'add component'</span>, m );
</pre>
<h2 id="9">Bus Frame</h2>
<pre class="codeinput">
<span class="comment">%------------</span>
[v, f]    = PanelFrame( xBox, yBox, panelThickness, panelThickness );
massFrame	= 2*(xBox + yBox)*panelThickness^2*rhoCarbonFiber;
m = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'vertex'</span>, v, <span class="string">'face'</span>, f,<span class="keyword">...</span>
                     <span class="string">'faceColor'</span>, <span class="string">'gold foil'</span>,<span class="string">'rA'</span>, [0;0;zBox-2*panelThickness],<span class="keyword">...</span>
                     <span class="string">'mass'</span>, massFrame, <span class="string">'name'</span>, <span class="string">'Top Frame'</span>, <span class="string">'body'</span>, 1, <span class="string">'inside'</span>, 0 );
BuildCADModel( <span class="string">'add component'</span>, m );

v = ([1 0 0; 0 1 0; 0 0 -1]*v')';
m = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'vertex'</span>, v, <span class="string">'face'</span>, f,<span class="keyword">...</span>
                     <span class="string">'faceColor'</span>, <span class="string">'gold foil'</span>,<span class="string">'rA'</span>, [0;0;2*panelThickness],<span class="keyword">...</span>
                     <span class="string">'mass'</span>, massFrame, <span class="string">'name'</span>, <span class="string">'Bottom Frame'</span>, <span class="string">'body'</span>, 1, <span class="string">'inside'</span>, 0 );
BuildCADModel( <span class="string">'add component'</span>, m );

z1     = 2*panelThickness;
z2     = z1 + zBox-2*panelThickness;
c      = [];
c.x    = [ -0.250 0     0     0.250  0.250  0      0     -0.250]*inToM;
c.y    = [  0.375 0.375 0.125 0.125 -0.375 -0.375 -0.125 -0.125]*inToM;
[v, f] = ShapedStrut( [0;0;z1], [0;0;z2], c );
angle  = 0;
sX     = [1  1 -1 -1];
sY     = [1 -1 -1  1];
massStrut = panelThickness^2*zBox*rhoCarbonFiber;
<span class="keyword">for</span> k = 1:4
  angle = angle + pi/2;
  xF    = sX(k)*(xBox/2 - panelThickness/2);
  yF    = sY(k)*(yBox/2 - panelThickness/2);
  b     = [cos(angle) sin(angle) 0;-sin(angle) cos(angle) 0;0 0 1];
  vR    = (b*v')';
  m     = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'vertex'</span>, vR, <span class="string">'face'</span>, f,<span class="keyword">...</span>
                           <span class="string">'faceColor'</span>, <span class="string">'gold foil'</span>,<span class="string">'rA'</span>, [xF;yF;0], <span class="keyword">...</span>
                           <span class="string">'mass'</span>, massStrut, <span class="string">'name'</span>, [<span class="string">'z strut'</span> num2str(k)], <span class="string">'body'</span>, 1,<span class="keyword">...</span>
                           <span class="string">'inside'</span>,0 );
  BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>
</pre>
<h2 id="10">Panels</h2>
<pre class="codeinput">
<span class="comment">%---------</span>
panelName = {<span class="string">'+X'</span> <span class="string">'-X'</span> <span class="string">'+Y'</span> <span class="string">'-Y'</span> <span class="string">'+Z'</span>  <span class="string">'-Z'</span>};
color     = {<span class="string">'gold foil'</span> <span class="string">'gold foil'</span> <span class="string">'gold foil'</span> <span class="string">'gold foil'</span> <span class="string">'gold foil'</span> <span class="string">'radiator'</span>};
xLoc      = (xBox - panelThickness)/2;
yLoc      = (yBox - panelThickness)/2;
zLoc      = (zBox - panelThickness)/2;

wX        = xBox - 2*panelThickness;
wY        = yBox - 2*panelThickness;
wZ        = zBox - 2*panelThickness;

th        = panelThickness;
zH        = zBox/2;

rAP       = [ xLoc -xLoc 0     0      0       0 ;<span class="keyword">...</span>
              0     0    yLoc -yLoc   0       0;<span class="keyword">...</span>
              zH    zH   zH    zH    zBox     0];

dP        =     [ th  th wX  wX  wX  wX ;<span class="keyword">...</span>
                  wY  wY th  th  wY  wY;<span class="keyword">...</span>
                  wZ  wZ wZ  wZ  th  th];

<span class="keyword">for</span> k = 1:6
    massPanel = dP(1,k)*dP(2,k)*dP(3,k)*rhoCarbonFiber;
    m = CreateComponent( <span class="string">'make'</span>, <span class="string">'box'</span>, <span class="string">'x'</span>, dP(1,k), <span class="string">'y'</span>,dP(2,k), <span class="string">'z'</span>,dP(3,k),<span class="keyword">...</span>
                         <span class="string">'faceColor'</span>, color{k}, <span class="string">'rA'</span>, rAP(:,k), <span class="string">'mass'</span>, massPanel,<span class="keyword">...</span>
                         <span class="string">'name'</span>, [<span class="string">'Panel '</span> panelName{k}], <span class="string">'body'</span>, 1,<span class="keyword">...</span>
                         <span class="string">'inside'</span>, 0 );
    BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>

<span class="comment">% Landing legs</span>
<span class="comment">%--------------</span>
rL        = 35;
[v, f]    = LandingLegsCAD(<span class="string">'scale'</span>,0.01,<span class="string">'xy spacing'</span>,rL);

m         = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'v'</span>,v,<span class="string">'f'</span>,f,<span class="keyword">...</span>
                             <span class="string">'faceColor'</span>, [1 0.84 0] ,<span class="string">'rA'</span>, [0;0;0],<span class="keyword">...</span>
                             <span class="string">'name'</span>, <span class="string">'Landing Legs'</span>,<span class="string">'inside'</span>,0);
BuildCADModel( <span class="string">'add component'</span>, m );

<span class="comment">% Battery</span>
<span class="comment">%---------</span>
rB        = 0.5*([0;yBox;0] + [-2*panelThickness;-wBattery-2*panelThickness;wBattery/2]);
m         = CreateComponent( <span class="string">'make'</span>, <span class="string">'box'</span>,<span class="string">'x'</span>, wBattery, <span class="string">'y'</span>, wBattery, <span class="string">'z'</span>, wBattery/2,<span class="keyword">...</span>
                             <span class="string">'faceColor'</span>, [0 1 0] ,<span class="string">'rA'</span>, rB,<span class="keyword">...</span>
                             <span class="string">'name'</span>, <span class="string">'Battery 1'</span>,<span class="string">'inside'</span>,1);
BuildCADModel( <span class="string">'add component'</span>, m );

<span class="comment">% Omni antennas</span>
<span class="comment">%---------------</span>
<span class="keyword">for</span> k = 1:2
    m = CreateComponent( <span class="string">'make'</span>, <span class="string">'cylinder'</span>, <span class="string">'rUpper'</span>, rOmni, <span class="string">'rLower'</span>, rOmni, <span class="string">'h'</span>, lOmni, <span class="string">'n'</span>, 24, <span class="string">'rA'</span>,xOmni(:,k),<span class="string">'b'</span>,bOmni{k},<span class="keyword">...</span>
                         <span class="string">'name'</span>, sprintf(<span class="string">'Omni %d'</span>,k), <span class="string">'body'</span>, 1, <span class="string">'mass'</span>, massOmni,<span class="string">'power'</span>,powerOmni, <span class="keyword">...</span>
                         <span class="string">'faceColor'</span>, [0 0 0], <span class="string">'inside'</span>, 1);
    BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>

<span class="comment">% High Gain Antenna</span>
<span class="comment">%-------------------</span>
m = CreateComponent(  <span class="string">'make'</span>, <span class="string">'ellipsoid'</span>, <span class="string">'name'</span>, <span class="string">'High Gain Antenna'</span>,<span class="keyword">...</span>
                      <span class="string">'body'</span>, 1, <span class="string">'abc'</span>, aBCHGA, <span class="string">'thetaUpper'</span>,pi/4,<span class="string">'b'</span>,[1 0 0;0 1 0;0 0 -1],<span class="keyword">...</span>
                      <span class="string">'n'</span>,10, <span class="string">'rA'</span>,[-1.2*xBox;0;1.4*zBox], <span class="string">'faceColor'</span>, <span class="string">'aluminum'</span>, <span class="string">'edgeColor'</span>,<span class="string">'aluminum'</span>,<span class="string">'power'</span>,powerHGA);
BuildCADModel(<span class="string">'add component'</span>, m );

<span class="comment">% Fuel tanks</span>
<span class="comment">%------------</span>
m         = CreateComponent( <span class="string">'make'</span>, <span class="string">'sphere'</span>,<span class="string">'radius'</span>, rTank,<span class="string">'n'</span>,20,<span class="keyword">...</span>
                             <span class="string">'faceColor'</span>, [0 1 0] ,<span class="string">'rA'</span>, rATank(:,1),<span class="string">'mass'</span>,fTank*massFuel/2,<span class="keyword">...</span>
                             <span class="string">'name'</span>, <span class="string">'HPGP Tank 1'</span>,<span class="string">'inside'</span>,1);

BuildCADModel( <span class="string">'add component'</span>, m );
m         = CreateComponent( <span class="string">'make'</span>, <span class="string">'sphere'</span>,<span class="string">'radius'</span>, rTank,<span class="string">'n'</span>,20,<span class="keyword">...</span>
                             <span class="string">'faceColor'</span>, [0 1 0] ,<span class="string">'rA'</span>, rATank(:,2),<span class="string">'mass'</span>,fTank*massFuel/2,<span class="keyword">...</span>
                             <span class="string">'name'</span>, <span class="string">'HPGP Tank 2'</span>,<span class="string">'inside'</span>,1);
BuildCADModel( <span class="string">'add component'</span>, m );

<span class="comment">% Star cameras</span>
<span class="comment">%--------------</span>
[v, f]  = StarCameraBasicModel( cameraAperture, cameraFocalLength, cameraApertureSunShade, cameraLengthSunShade );

m         = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'v'</span>, v, <span class="string">'f'</span>, f, <span class="string">'b'</span>, bCamera{1},<span class="keyword">...</span>
                             <span class="string">'rA'</span>, rCamera(:,1), <span class="string">'name'</span>, <span class="string">'Star Camera 1'</span>, <span class="string">'body'</span>, 1, <span class="string">'mass'</span>, massCamera );
BuildCADModel( <span class="string">'add component'</span>, m );

m         = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'v'</span>, v, <span class="string">'f'</span>, f, <span class="string">'b'</span>, bCamera{2},<span class="keyword">...</span>
                             <span class="string">'rA'</span>, rCamera(:,2), <span class="string">'name'</span>, <span class="string">'Star Camera 2'</span>, <span class="string">'body'</span>, 1, <span class="string">'mass'</span>, massCamera );
BuildCADModel( <span class="string">'add component'</span>, m );
</pre>
<h2 id="11">Sun sensors</h2>
<pre class="codeinput">
<span class="comment">%--------------</span>
<span class="keyword">for</span> k = 1:6
  <span class="keyword">switch</span> bSunSensor(k)
    <span class="keyword">case</span> -1
      rA = [-xBox/2 - zSunSensor/2;-yBox/2+xSunSensor/2;ySunSensor];
      b  = [0 0 -1;0 1 0;1 0 0];
    <span class="keyword">case</span>  1
      rA = [ xBox/2 + zSunSensor/2;-yBox/2+xSunSensor/2;ySunSensor];
      b  = [0 0 1;0 1 0;-1 0 0];
    <span class="keyword">case</span> -2
      rA = [ xBox/2-xSunSensor/2;-yBox/2 - zSunSensor/2;xSunSensor];
      b  = [1 0 0;0 0 -1;0 1 0];
    <span class="keyword">case</span> 2
      rA = [ xBox/2-xSunSensor/2;yBox/2 + zSunSensor/2;xSunSensor];
      b  = [1 0 0;0 0 1;0 -1 0];
    <span class="keyword">case</span> -3
      rA = [ xBox/2-xSunSensor/2;yBox/2-ySunSensor/2;-zSunSensor/2];
      b  = [1 0 0;0 1 0;0 0 -1];
    <span class="keyword">case</span> 3
      rA = [ xBox/2-xSunSensor/2;yBox/2-ySunSensor/2;zBox + zSunSensor/2];
      b  = eye(3);
  <span class="keyword">end</span>
	m = CreateComponent( <span class="string">'make'</span>, <span class="string">'box'</span>, <span class="string">'x'</span>, xSunSensor, <span class="string">'y'</span>, ySunSensor, <span class="string">'z'</span>, zSunSensor, <span class="string">'b'</span>,b,<span class="string">'mass'</span>,massSunSensor,<span class="keyword">...</span>
                     <span class="string">'inside'</span>, 1, <span class="string">'rA'</span>, rA, <span class="string">'name'</span>, sprintf(<span class="string">'Sun Sensor %d'</span>,k), <span class="string">'body'</span>, 1, <span class="string">'faceColor'</span>, [0.25 1 0.8], <span class="string">'power'</span>, powerSunSensor );
  BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>

<span class="comment">% IMU</span>
<span class="comment">%-----</span>
rIMU            = [ xBox/2-radiusIMU-4*panelThickness;<span class="keyword">...</span>
                    yBox/2-radiusIMU-4*panelThickness;<span class="keyword">...</span>
                    panelThickness];
m = CreateComponent( <span class="string">'make'</span>, <span class="string">'cylinder'</span>, <span class="string">'rUpper'</span>, radiusIMU, <span class="string">'rLower'</span>,radiusIMU,<span class="string">'h'</span>,hIMU,<span class="keyword">...</span>
                     <span class="string">'inside'</span>, 1,<span class="string">'deviceInfo'</span>,dIMU,<span class="keyword">...</span>
                     <span class="string">'rA'</span>, rIMU, <span class="string">'name'</span>, <span class="string">'IMU'</span>, <span class="string">'body'</span>, 1, <span class="string">'faceColor'</span>, [0 0 1], <span class="string">'power'</span>, powerIMU );
BuildCADModel( <span class="string">'add component'</span>, m );


<span class="comment">% Chassis</span>
<span class="comment">%---------</span>
m = CreateComponent( <span class="string">'make'</span>, <span class="string">'box'</span>, <span class="string">'x'</span>, xChassis, <span class="string">'y'</span>, yChassis, <span class="string">'z'</span>, zChassis, <span class="string">'faceColor'</span>, [0 0.5 0.5],<span class="keyword">...</span>
                     <span class="string">'rA'</span>, [-xBox/2 + xChassis/2 + 2*panelThickness; -yBox/2 + yChassis/2 + 2*panelThickness; zBox - zChassis/2 - 2*panelThickness],<span class="keyword">...</span>
                     <span class="string">'mass'</span>, massChassis, <span class="string">'name'</span>, <span class="string">'C&amp;DH Box'</span>, <span class="string">'body'</span>, 1, <span class="string">'inside'</span>, 1 );
BuildCADModel( <span class="string">'add component'</span>, m );

<span class="comment">% Thrusters</span>
<span class="comment">%----------</span>
<span class="keyword">for</span> k = 1:7
  [v, f]  = ThrusterCAD( -uThruster(:,k), dConeThruster(k), lThruster(k), 12, rThrusterElec(k), lThrusterElec(k) );
  s       = sprintf(<span class="string">'Thruster %d'</span>,k);
  m       = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'v'</span>, v, <span class="string">'f'</span>, f, <span class="string">'faceColor'</span>, [0 0.5 0.5],<span class="keyword">...</span>
                       <span class="string">'rA'</span>,  rThruster(:,k), <span class="string">'mass'</span>, massThruster(k), <span class="string">'name'</span>, s, <span class="string">'body'</span>, 1, <span class="string">'inside'</span>, 0 );
  BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>
</pre>
<img vspace="5" hspace="5" src="LunarLanderCAD_02.png" alt=""> <h2 id="12">Add subsystems</h2>
<pre class="codeinput">
<span class="comment">%----------------</span>
BuildCADModel( <span class="string">'add subsystem'</span>, <span class="string">'ACS'</span>,                    {<span class="string">'star camera'</span>,<span class="string">'rwa'</span>} );
BuildCADModel( <span class="string">'add subsystem'</span>, <span class="string">'Propulsion'</span>,             {<span class="string">'thruster'</span>,<span class="string">'tank'</span>} );
BuildCADModel( <span class="string">'add subsystem'</span>, <span class="string">'Telemetry and Command'</span>,	{<span class="string">'C&amp;DH'</span>, <span class="string">'omni'</span>, <span class="string">'signal'</span>,<span class="string">'processor'</span>, <span class="string">'antenna'</span>, <span class="string">'board'</span>} );
BuildCADModel( <span class="string">'add subsystem'</span>, <span class="string">'mechanism'</span>,              {<span class="string">'drive'</span>} );
BuildCADModel( <span class="string">'add subsystem'</span>, <span class="string">'power'</span>,                  {<span class="string">'solar array'</span>, <span class="string">'battery'</span>} );
BuildCADModel( <span class="string">'add subsystem'</span>, <span class="string">'structure'</span>,              {<span class="string">'support'</span>, <span class="string">'frame'</span>, <span class="string">'strut'</span>, <span class="string">'panel'</span>} );
</pre>
<h2 id="13">Update the mass properties to produce the tables</h2>
<pre class="codeinput">
<span class="comment">%--------------------------------------------------</span>
BuildCADModel( <span class="string">'update body mass properties'</span> );

g = BuildCADModel( <span class="string">'get model'</span> );
BuildCADModel(<span class="string">'show vehicle'</span>);
DrawCAD( g );

CreateReport( g, <span class="string">'tex'</span>, FileFullpath(<span class="string">'LunarLanderMass'</span>),    <span class="string">'mass'</span>,  1, 1, 1 )
CreateReport( g, <span class="string">'tex'</span>, FileFullpath(<span class="string">'LunarLanderPower'</span>),  <span class="string">'power'</span>,  1, 1, 1 )
</pre>
<img vspace="5" hspace="5" src="LunarLanderCAD_03.png" alt=""> <img vspace="5" hspace="5" src="LunarLanderCAD_04.png" alt=""> <img vspace="5" hspace="5" src="LunarLanderCAD_05.png" alt=""> <h2 id="14">Export to obj</h2>
<pre class="codeinput">
<span class="comment">%---------------</span>
ExportOBJ(g,FileFullpath(<span class="string">'LunarLander'</span>));


<span class="comment">%--------------------------------------</span>
<span class="comment">% PSS internal file version information</span>
<span class="comment">%--------------------------------------</span>

<span class="comment">% $Id: 03cd9627730e6ac2362dd445d3f559838b2b8d6c $</span>
</pre>
<p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024a</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% Generate lunar lander CAD model
% Generate a CAD model of a lunary lander. Creates power and mass reports
% of the model and exports it to OBJ. Loads RCS.mat for thruster data.
% 
% Components in the model:
%
%  GN&C
%  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%  1 IMU                       
%  6 Sun sensors
%  1 Star camera
%  1 Navigation camera
%
%  Communications
%  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%  2 Omni antenna              
%  1 High gain antenna         
%
%  Power
%  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%  1 LiOn battery              
%  2 Solar arrays           
%
%  Data processing
%  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%  1 RAD 5545 processor (cPCI)  
%  1 Interface board   (cPCI)  
%  1 Mass memory board (cPCI)  
%  1 Command receiver  (cPCI)  
%  1 GPS receiver      (cPCI)  
%
%  Structure
%  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%  Composite frame              
%  Composite panels            
%
%  See also BuildCADModel, CreateReport, ExportOBJ, DrawCAD
%  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%%
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%   Copyright (c) 2014 Princeton Satellite Systems, Inc.
%   All rights reserved.
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% Multibody switch
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
multiBody = false;

%% Constants
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
rhoCarbonFiber  = 1600;
rhoAluminum     = 2700;
rhoGlass        = 2400;
rhoSteel        = 8000;
rhoTungsten     = 15630;
inToM           = 0.0254;
solarFlux       = 1367;
rhoSolarPanel   = 10.3e3/36.4; % Dawn spacecraft
lToM3           = 0.001; % Liters to cubic meters

%% Mission date
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
date            = [2015 5 7 0 0 0];
jD              = Date2JD(date);

%% Mission information
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
hOrbit          = 450;
sma             = hOrbit + 6378.165;
inc             = 80*pi/180;
omega           = 5*pi/180; % Angular rate
omegaDot        = omega/5;
tRWA            = 0.01;

%% Spacecraft hardware parameters
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

% Thrusters
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% LunarRCS.mat is a file with data fields rThruster and uThruster, which are
% used in the thruster components
load LunarRCS.mat
lThruster     = [0.1   0.026 0.026 0.026 0.026 0.026 0.026];
rThrusterElec	= [0.05   0.01  0.01  0.01  0.01  0.01  0.01];
lThrusterElec = [0.1   0.15  0.15  0.15  0.15  0.15  0.15];
massThruster  = [2.00  0.34  0.34  0.34  0.34  0.34  0.34];
dConeThruster = [0.1   0.02  0.02  0.02  0.02  0.02  0.02];

% Bus
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
u                 = 0.1;
zBox              = 4*u;
xBox              = 6.8*u;
yBox              = 6.8*u;
panelThickness    = 0.004;

% Inertia
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
inertia   = [1.1565   -0.0074    0.0561;...
            -0.0074    1.0380    0.02281;...
             0.0561    0.0228    0.7354];
                    
% Fuel tank
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
mFuelLRO	              = 654;
rhoHPGP                 = mFuelLRO/0.56;
fTank                   = 49/mFuelLRO;
massFuel                = 67.63;
volFuel                 = massFuel/rhoHPGP/2;
rTank                   = (volFuel/(4*pi/3))^(1/3);
f                       = 0.8;
rATank                  = [f*rTank*[1 -1;1 -1];zBox/2 zBox/2];

% Star camera
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
cameraAperture          = 12.5;
cameraFocalLength       = 25.0;
cameraLengthSunShade    = 35.0;
cameraApertureSunShade	= 25.0;
massCamera              = 0.25;
rCamera                 = 0.4*[xBox -xBox;-yBox yBox;zBox zBox];
uC                      = [0;0;1];
v1                      = Unit([1;-1;-1]);
v2                      = Unit([-1;1;-1]);
b1                      = Q2Mat(U2Q(uC,v1));
b2                      = Q2Mat(U2Q(uC,v2));
bCamera                 = {b1 b2};

% High Gain Antenna
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
aBCHGA            = [0.8*xBox 0.8*xBox 0.2*xBox];
powerHGA          = 20;

% Omni antennas
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
powerOmni         = 2;
xOmni             = [xBox xBox; yBox -yBox; 0 0]/2;
rOmni             = 0.002;
c                 = Constant('speed of light')*1000; % m/s
fComm             = 2e9; % sband
lOmni             = 0.5*c/fComm;
massOmni          = lOmni*pi*rOmni^2*rhoAluminum;
bOmni             = {[1 0 0;0 0 1;0 -1 0] [1 0 0;0 0 -1;0 1 0]};

% IMU LN-200S
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
radiusIMU         = 0.0889/2;
hIMU              = 0.0851;
massIMU           = 0.748;
dIMU.manufacturer = 'Northrop Grumman';
dIMU.name         = 'LN-200S';
powerIMU          = 12;

% Sun Sensors
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
massSunSensor     = 0.035;
xSunSensor        = 0.06;
ySunSensor        = 0.03;
zSunSensor        = 0.012;
bSunSensor        = [1 -1 2 -2 3 -3];
powerSunSensor    = 0.6;

% Processing boards - 3U CompactPCI boards
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
nBoards           = 5;
powerBoard        = 12;
xChassis          = 0.16 + 0.02;
yChassis          = 0.1 + 0.02;
zChassis          = 0.02*nBoards + 0.02;
massChassis       = 1;

% Solar arrays
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
massSAD                 = 0.2;
solarPanelThickness     = 0.004;
strutLength             = yBox/2;
nPanels                 = 2;
panelLength             = zBox;
panelWidth              = xBox;
massSolarPanel          = panelLength*panelWidth*rhoSolarPanel;
solarPanelEff           = 0.295;
zSolarWing              = zBox/2;
arrayMassFront          = 0.5*solarPanelThickness*panelLength*panelWidth*nPanels*rhoGlass;
arrayMassBack           = 0.5*solarPanelThickness*panelLength*panelWidth*nPanels*rhoCarbonFiber;
massStrut               = 0.1;
yPanel                  = yBox/6;

bX                      = [ 1 0 0;0 0 -1;0 1  0]';
bY                      = [-1 0 0;0 1  0;0 0 -1];

% Battery
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
power                     = 2*solarPanelEff*solarFlux*nPanels*panelLength*panelWidth;
powerNight                = 5;
massBattery               = powerNight*24*15/135; % Saft batteries
volBattery                = powerNight*24*15/250;
wBattery                  = (2*volBattery*lToM3)^(1/3); % One length is half the others

%% Initialize BuildCADModel and create the Core body
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
BuildCADModel( 'initialize' );
BuildCADModel( 'set name' , 'LunarLander' );
BuildCADModel( 'set units', 'mks' );

% Core
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
m = CreateBody('make','name','Core');
BuildCADModel('add body', m );

if( multiBody )
  rHinge = [0;0;panelWidth/2];
else
  rHinge = [0;0;0];
end
m = CreateBody('make','name','SolarWing','rHinge',rHinge,'previousBody',1);
BuildCADModel('add body', m );

if( ~multiBody )
  zPanel = zBox+panelWidth/2;
  zStrut  = zBox;
end

% This creates the connections between the bodies
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
BuildCADModel( 'compute paths' );

%% Components

% Solar Array 1
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
m = CreateComponent( 'make', 'box', 'x',panelWidth, 'y',nPanels*panelLength, 'z',solarPanelThickness,...
                     'faceColor', 'solar cell', 'rA', [0;yPanel+panelLength;zPanel], 'mass', massSolarPanel,...
                     'name','Solar Array +Y', 'body', 2,...
                     'inside', 0, 'power', -power/2 );
                   
BuildCADModel( 'add component', m );
                     
% Solar Array 2
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-

m = CreateComponent( 'make', 'box', 'x',panelWidth, 'y',nPanels*panelLength, 'z',solarPanelThickness,...
                     'faceColor', 'solar cell', 'rA', [0;-yPanel-panelLength;zPanel], 'mass', massSolarPanel,...
                     'name','Solar Array -Y', 'body', 2,...
                     'inside', 0, 'power', -power/2 );
                   
BuildCADModel( 'add component', m );

% Horizontal motor
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
m = CreateComponent( 'make', 'cylinder', 'rUpper', 0.02, 'rLower', 0.02, 'h', 2*yPanel, 'n', 24, 'rA',[0;-yPanel;zPanel],...
                         'name', 'Motor', 'body', 2, 'mass', massStrut,'power',0,'b',[1 0 0;0 0 1;0 -1 0],... 
                         'faceColor', [0 0 0], 'inside', 1);
BuildCADModel( 'add component', m );

% Vertical strut
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
m = CreateComponent( 'make', 'cylinder', 'rUpper', 0.01, 'rLower', 0.01, 'h', panelWidth/2, 'n', 24, 'rA',[0;0;zStrut],...
                         'name', 'Motor', 'body', 1, 'mass', massStrut,'power',0, ...
                         'faceColor', [0 0 0], 'inside', 1);
BuildCADModel( 'add component', m );



%%% Bus Frame
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
[v, f]    = PanelFrame( xBox, yBox, panelThickness, panelThickness );
massFrame	= 2*(xBox + yBox)*panelThickness^2*rhoCarbonFiber;
m = CreateComponent( 'make', 'generic', 'vertex', v, 'face', f,...
                     'faceColor', 'gold foil','rA', [0;0;zBox-2*panelThickness],...
                     'mass', massFrame, 'name', 'Top Frame', 'body', 1, 'inside', 0 );
BuildCADModel( 'add component', m );

v = ([1 0 0; 0 1 0; 0 0 -1]*v')';
m = CreateComponent( 'make', 'generic', 'vertex', v, 'face', f,...
                     'faceColor', 'gold foil','rA', [0;0;2*panelThickness],...
                     'mass', massFrame, 'name', 'Bottom Frame', 'body', 1, 'inside', 0 );
BuildCADModel( 'add component', m );

z1     = 2*panelThickness;
z2     = z1 + zBox-2*panelThickness; 
c      = [];
c.x    = [ -0.250 0     0     0.250  0.250  0      0     -0.250]*inToM;
c.y    = [  0.375 0.375 0.125 0.125 -0.375 -0.375 -0.125 -0.125]*inToM;
[v, f] = ShapedStrut( [0;0;z1], [0;0;z2], c );
angle  = 0;
sX     = [1  1 -1 -1];
sY     = [1 -1 -1  1];
massStrut = panelThickness^2*zBox*rhoCarbonFiber;
for k = 1:4
  angle = angle + pi/2;
  xF    = sX(k)*(xBox/2 - panelThickness/2);
  yF    = sY(k)*(yBox/2 - panelThickness/2);
  b     = [cos(angle) sin(angle) 0;-sin(angle) cos(angle) 0;0 0 1];
  vR    = (b*v')';
  m     = CreateComponent( 'make', 'generic', 'vertex', vR, 'face', f,...
                           'faceColor', 'gold foil','rA', [xF;yF;0], ...
                           'mass', massStrut, 'name', ['z strut' num2str(k)], 'body', 1,...
                           'inside',0 );
  BuildCADModel( 'add component', m );
end

%%% Panels
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
panelName = {'+X' '-X' '+Y' '-Y' '+Z'  '-Z'};
color     = {'gold foil' 'gold foil' 'gold foil' 'gold foil' 'gold foil' 'radiator'};
xLoc      = (xBox - panelThickness)/2;
yLoc      = (yBox - panelThickness)/2;
zLoc      = (zBox - panelThickness)/2;
			 
wX        = xBox - 2*panelThickness;
wY        = yBox - 2*panelThickness;
wZ        = zBox - 2*panelThickness;

th        = panelThickness;
zH        = zBox/2;

rAP       = [ xLoc -xLoc 0     0      0       0 ;...
              0     0    yLoc -yLoc   0       0;...
              zH    zH   zH    zH    zBox     0];
			 
dP        =     [ th  th wX  wX  wX  wX ;...
                  wY  wY th  th  wY  wY;...
                  wZ  wZ wZ  wZ  th  th];            

for k = 1:6
    massPanel = dP(1,k)*dP(2,k)*dP(3,k)*rhoCarbonFiber;
    m = CreateComponent( 'make', 'box', 'x', dP(1,k), 'y',dP(2,k), 'z',dP(3,k),...
                         'faceColor', color{k}, 'rA', rAP(:,k), 'mass', massPanel,...
                         'name', ['Panel ' panelName{k}], 'body', 1,...
                         'inside', 0 );
    BuildCADModel( 'add component', m );
end

% Landing legs
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
rL        = 35;
[v, f]    = LandingLegsCAD('scale',0.01,'xy spacing',rL);

m         = CreateComponent( 'make', 'generic', 'v',v,'f',f,...
                             'faceColor', [1 0.84 0] ,'rA', [0;0;0],...
                             'name', 'Landing Legs','inside',0);
BuildCADModel( 'add component', m );

% Battery
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
rB        = 0.5*([0;yBox;0] + [-2*panelThickness;-wBattery-2*panelThickness;wBattery/2]);
m         = CreateComponent( 'make', 'box','x', wBattery, 'y', wBattery, 'z', wBattery/2,...
                             'faceColor', [0 1 0] ,'rA', rB,...
                             'name', 'Battery 1','inside',1);
BuildCADModel( 'add component', m );

% Omni antennas
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
for k = 1:2
    m = CreateComponent( 'make', 'cylinder', 'rUpper', rOmni, 'rLower', rOmni, 'h', lOmni, 'n', 24, 'rA',xOmni(:,k),'b',bOmni{k},...
                         'name', sprintf('Omni %d',k), 'body', 1, 'mass', massOmni,'power',powerOmni, ...
                         'faceColor', [0 0 0], 'inside', 1);
    BuildCADModel( 'add component', m );
end

% High Gain Antenna
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
m = CreateComponent(  'make', 'ellipsoid', 'name', 'High Gain Antenna',...
                      'body', 1, 'abc', aBCHGA, 'thetaUpper',pi/4,'b',[1 0 0;0 1 0;0 0 -1],...
                      'n',10, 'rA',[-1.2*xBox;0;1.4*zBox], 'faceColor', 'aluminum', 'edgeColor','aluminum','power',powerHGA);
BuildCADModel('add component', m );

% Fuel tanks
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
m         = CreateComponent( 'make', 'sphere','radius', rTank,'n',20,...
                             'faceColor', [0 1 0] ,'rA', rATank(:,1),'mass',fTank*massFuel/2,...
                             'name', 'HPGP Tank 1','inside',1);
                           
BuildCADModel( 'add component', m );
m         = CreateComponent( 'make', 'sphere','radius', rTank,'n',20,...
                             'faceColor', [0 1 0] ,'rA', rATank(:,2),'mass',fTank*massFuel/2,...
                             'name', 'HPGP Tank 2','inside',1);
BuildCADModel( 'add component', m );

% Star cameras
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
[v, f]  = StarCameraBasicModel( cameraAperture, cameraFocalLength, cameraApertureSunShade, cameraLengthSunShade );

m         = CreateComponent( 'make', 'generic', 'v', v, 'f', f, 'b', bCamera{1},...
                             'rA', rCamera(:,1), 'name', 'Star Camera 1', 'body', 1, 'mass', massCamera );
BuildCADModel( 'add component', m );

m         = CreateComponent( 'make', 'generic', 'v', v, 'f', f, 'b', bCamera{2},...
                             'rA', rCamera(:,2), 'name', 'Star Camera 2', 'body', 1, 'mass', massCamera );
BuildCADModel( 'add component', m );

%%% Sun sensors
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
for k = 1:6
  switch bSunSensor(k)
    case -1
      rA = [-xBox/2 - zSunSensor/2;-yBox/2+xSunSensor/2;ySunSensor];
      b  = [0 0 -1;0 1 0;1 0 0];
    case  1
      rA = [ xBox/2 + zSunSensor/2;-yBox/2+xSunSensor/2;ySunSensor];
      b  = [0 0 1;0 1 0;-1 0 0];
    case -2
      rA = [ xBox/2-xSunSensor/2;-yBox/2 - zSunSensor/2;xSunSensor];
      b  = [1 0 0;0 0 -1;0 1 0];
    case 2
      rA = [ xBox/2-xSunSensor/2;yBox/2 + zSunSensor/2;xSunSensor];
      b  = [1 0 0;0 0 1;0 -1 0];
    case -3
      rA = [ xBox/2-xSunSensor/2;yBox/2-ySunSensor/2;-zSunSensor/2];
      b  = [1 0 0;0 1 0;0 0 -1];
    case 3
      rA = [ xBox/2-xSunSensor/2;yBox/2-ySunSensor/2;zBox + zSunSensor/2];
      b  = eye(3);
  end
	m = CreateComponent( 'make', 'box', 'x', xSunSensor, 'y', ySunSensor, 'z', zSunSensor, 'b',b,'mass',massSunSensor,...
                     'inside', 1, 'rA', rA, 'name', sprintf('Sun Sensor %d',k), 'body', 1, 'faceColor', [0.25 1 0.8], 'power', powerSunSensor );
  BuildCADModel( 'add component', m );
end

% IMU
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
rIMU            = [ xBox/2-radiusIMU-4*panelThickness;...
                    yBox/2-radiusIMU-4*panelThickness;...
                    panelThickness];
m = CreateComponent( 'make', 'cylinder', 'rUpper', radiusIMU, 'rLower',radiusIMU,'h',hIMU,...
                     'inside', 1,'deviceInfo',dIMU,...
                     'rA', rIMU, 'name', 'IMU', 'body', 1, 'faceColor', [0 0 1], 'power', powerIMU );
BuildCADModel( 'add component', m );


% Chassis
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
m = CreateComponent( 'make', 'box', 'x', xChassis, 'y', yChassis, 'z', zChassis, 'faceColor', [0 0.5 0.5],...
                     'rA', [-xBox/2 + xChassis/2 + 2*panelThickness; -yBox/2 + yChassis/2 + 2*panelThickness; zBox - zChassis/2 - 2*panelThickness],...
                     'mass', massChassis, 'name', 'C&DH Box', 'body', 1, 'inside', 1 );
BuildCADModel( 'add component', m );

% Thrusters
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
for k = 1:7
  [v, f]  = ThrusterCAD( -uThruster(:,k), dConeThruster(k), lThruster(k), 12, rThrusterElec(k), lThrusterElec(k) );
  s       = sprintf('Thruster %d',k);
  m       = CreateComponent( 'make', 'generic', 'v', v, 'f', f, 'faceColor', [0 0.5 0.5],...
                       'rA',  rThruster(:,k), 'mass', massThruster(k), 'name', s, 'body', 1, 'inside', 0 );
  BuildCADModel( 'add component', m );
end


%% Add subsystems
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
BuildCADModel( 'add subsystem', 'ACS',                    {'star camera','rwa'} );
BuildCADModel( 'add subsystem', 'Propulsion',             {'thruster','tank'} );
BuildCADModel( 'add subsystem', 'Telemetry and Command',	{'C&DH', 'omni', 'signal','processor', 'antenna', 'board'} );
BuildCADModel( 'add subsystem', 'mechanism',              {'drive'} );
BuildCADModel( 'add subsystem', 'power',                  {'solar array', 'battery'} );
BuildCADModel( 'add subsystem', 'structure',              {'support', 'frame', 'strut', 'panel'} );

%% Update the mass properties to produce the tables
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
BuildCADModel( 'update body mass properties' );

g = BuildCADModel( 'get model' );
BuildCADModel('show vehicle');
DrawCAD( g );

CreateReport( g, 'tex', FileFullpath('LunarLanderMass'),    'mass',  1, 1, 1 )
CreateReport( g, 'tex', FileFullpath('LunarLanderPower'),  'power',  1, 1, 1 )

%% Export to obj
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
ExportOBJ(g,FileFullpath('LunarLander'));


%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% PSS internal file version information
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% $Date:   LunarLanderCAD.m $
% $Id: 03cd9627730e6ac2362dd445d3f559838b2b8d6c $
##### SOURCE END #####
-->
</body>
</html>
