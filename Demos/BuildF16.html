
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Build the F16 Model.</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-03-24"><meta name="DC.source" content="BuildF16.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Build the F16 Model.</h1><!--introduction--><p>Loads an OBJ file first, which may take a few minutes.  ------------------------------------------------------------------------  See also BHinge, BuildCADModel, CreateBody, CreateComponent, LoadCAD,  QLVLH, Constant, TesselatePolygon  ------------------------------------------------------------------------</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Read in the model</a></li><li><a href="#3">Read in the model</a></li><li><a href="#4">Point the nose along x and tail along z</a></li><li><a href="#5">Convert to triangles</a></li><li><a href="#6">Want metric</a></li><li><a href="#7">Use the CAD interface</a></li><li><a href="#8">Create the bodies</a></li><li><a href="#9">Rudder</a></li><li><a href="#10">Aileron Right</a></li><li><a href="#11">Aileron Left</a></li><li><a href="#12">Elevator</a></li><li><a href="#13">This creates the connections between the bodies</a></li><li><a href="#14">Assign components to the core</a></li><li><a href="#15">Add in the engine</a></li><li><a href="#16">Add in the control surfaces</a></li><li><a href="#17">Rudder</a></li><li><a href="#18">Ailerons</a></li><li><a href="#19">Elevator</a></li><li><a href="#20">Sensors</a></li><li><a href="#21">Display</a></li></ul></div><pre class="codeinput"><span class="comment">%-------------------------------------------------------------------------------</span>
<span class="comment">%   Copyright (c) 2002 Princeton Satellite Systems, Inc. All rights reserved.</span>
<span class="comment">%-------------------------------------------------------------------------------</span>
</pre><h2>Read in the model<a name="2"></a></h2><pre class="codeinput"><span class="comment">%------------------</span>
r         = 6378.165 + 10;
v         = 502;
rECI      = [r;0;0];
vECI      = [0;v;0];
qLVLH     = QLVLH( rECI, vECI );
q         = [1;0;0;0];
omega     = [0;0;0];

lengthF16	= 14.8;
</pre><h2>Read in the model<a name="3"></a></h2><pre class="codeinput"><span class="comment">%------------------</span>
disp(<span class="string">'Load the OBJ file...'</span>)
g       = LoadCAD(<span class="string">'F16dof.obj'</span>);
disp(<span class="string">'Finished loading. Build the model...'</span>)
</pre><pre class="codeoutput">Load the OBJ file...
Finished loading. Build the model...
</pre><h2>Point the nose along x and tail along z<a name="4"></a></h2><pre class="codeinput"><span class="comment">%----------------------------------------</span>
b       = [1 0 0;0 0 1;0 -1 0]*[0 0 1; 0 1 0; -1 0 0];

<span class="keyword">for</span> k = 1:length(g.component)
   g.component(k).v = (b*g.component(k).v')';
<span class="keyword">end</span>

maxX = 0;
minX = 0;
<span class="keyword">for</span> k = 1:length(g.component)
   maxX = max([maxX  g.component(k).v(:,1)']);
   minX = min([minX  g.component(k).v(:,1)']);
<span class="keyword">end</span>
scale = lengthF16/(maxX - minX);

<span class="keyword">for</span> k = 1:length(g.component)
   g.component(k).v = g.component(k).v*scale;
<span class="keyword">end</span>
</pre><h2>Convert to triangles<a name="5"></a></h2><pre class="codeinput"><span class="comment">%---------------------</span>
g       = TesselatePolygon( g );
</pre><h2>Want metric<a name="6"></a></h2><pre class="codeinput"><span class="comment">%------------</span>
inertiaConv = Constant(<span class="string">'slug-ft^2 to kg-m^2'</span>);
massConv    = Constant(<span class="string">'lb force to kg'</span>);
mass        = struct( <span class="string">'mass'</span>, 20500*massConv,<span class="keyword">...</span>
                      <span class="string">'inertia'</span>, [9497 0 -982; 0 55814 0 ;-982 0 63100]*inertiaConv,<span class="keyword">...</span>
                      <span class="string">'cM'</span>, [0;0;0] );
</pre><h2>Use the CAD interface<a name="7"></a></h2><pre class="codeinput"><span class="comment">%----------------------</span>
BuildCADModel( <span class="string">'initialize'</span> );
BuildCADModel( <span class="string">'set mass'</span>,                   mass  );
BuildCADModel( <span class="string">'set name'</span> ,                 <span class="string">'F16'</span>     );
BuildCADModel( <span class="string">'set units'</span>,                 <span class="string">'mks'</span>     );
BuildCADModel( <span class="string">'set rECI'</span> ,                  rECI     );
BuildCADModel( <span class="string">'set vECI'</span> ,                  vECI     );
BuildCADModel( <span class="string">'set qLVLH'</span>,                  qLVLH    );
BuildCADModel( <span class="string">'set qECIToBody'</span>,             q        );
BuildCADModel( <span class="string">'set omega'</span>,                  omega    );
BuildCADModel( <span class="string">'set aerodynamic model'</span>,      <span class="string">'F16Aerodynamics'</span>  );
BuildCADModel( <span class="string">'set aerodynamic model file'</span>, <span class="string">':Data:AeroDataFile.txt'</span> );

<span class="comment">% For each component, we need to find its origin and displace it so that</span>
<span class="comment">% the axis of rotation is at the origin</span>
<span class="comment">%-----------------------------------------------------------------------</span>
</pre><img vspace="5" hspace="5" src="BuildF16_01.png" alt=""> <h2>Create the bodies<a name="8"></a></h2><pre class="codeinput"><span class="comment">%------------------</span>
bodyName = {<span class="string">'core'</span> <span class="string">'rudder'</span> <span class="string">'aileronRight'</span> <span class="string">'aileronLeft'</span> <span class="string">'elevator'</span> };
axisRot  = [0 3 2 2 2];
</pre><h2>Rudder<a name="9"></a></h2><pre class="codeinput"><span class="comment">%-------</span>
dZ               = 4;
dY               = max(g.component(1).v(:,2)) - min(g.component(1).v(:,2));
angle            = atan(dZ/dY);
c                = cos(angle);
s                = sin(angle);
bHinge{2}        = [c  s 0; -s  c 0; 0 0 1];
rudderUnitVector = bHinge{2}'*[0;1;0];
y                = mean(g.component(1).v(:,2));
x                = mean(g.component(1).v(:,1));
rHinge(:,2)      = [x;y;0];
rRudderDrive     = [max(g.component(1).v(:,1));min(g.component(1).v(:,2));0];
kInRudder        = 1;

<span class="keyword">for</span> k = kInRudder
  <span class="keyword">for</span> j = 1:3
    g.component(k).v(:,j) = g.component(k).v(:,j) - rHinge(j,2);
  <span class="keyword">end</span>
<span class="keyword">end</span>
g.component(1).v = (bHinge{2}'*g.component(1).v')';
</pre><h2>Aileron Right<a name="10"></a></h2><pre class="codeinput"><span class="comment">%--------------</span>
x                = mean(g.component(2).v(:,1));
rHinge(:,3)      = [x;0;0];
bHinge{3}        = eye(3);
kInAileronRight  = 2;
<span class="keyword">for</span> k = kInAileronRight
  <span class="keyword">for</span> j = 1:3
    g.component(k).v(:,j) = g.component(k).v(:,j) - rHinge(j,3);
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><h2>Aileron Left<a name="11"></a></h2><pre class="codeinput"><span class="comment">%-------------</span>
x                = mean(g.component(3).v(:,1));
rHinge(:,4)      = [x;0;0];
bHinge{4}        = eye(3);
kInAileronLeft   = 3;
<span class="keyword">for</span> k = kInAileronLeft
  <span class="keyword">for</span> j = 1:3
    g.component(k).v(:,j) = g.component(k).v(:,j) - rHinge(j,4);
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><h2>Elevator<a name="12"></a></h2><pre class="codeinput"><span class="comment">%---------</span>
y                = mean(g.component(4).v(:,2));
x                = mean(g.component(4).v(:,1));
rHinge(:,5)      = [x;0;0];
bHinge{5}        = eye(3);
kInElevator      = [4 6];
<span class="keyword">for</span> k = kInElevator
  <span class="keyword">for</span> j = 1:3
    g.component(k).v(:,j) = g.component(k).v(:,j) - rHinge(j,5);
  <span class="keyword">end</span>
<span class="keyword">end</span>

m = CreateBody( <span class="string">'make'</span>, <span class="string">'name'</span>, <span class="string">'Core'</span> );
BuildCADModel( <span class="string">'add body'</span>, m );

<span class="keyword">for</span> k = 2:length(bodyName)
   m = CreateBody( <span class="string">'make'</span>, <span class="string">'name'</span>, bodyName{k}, <span class="string">'bHinge'</span>, struct( <span class="string">'b'</span>, bHinge{k}, <span class="string">'axis'</span>, axisRot(k) ), <span class="string">'previousBody'</span>, 1, <span class="string">'rHinge'</span>, rHinge(:,k) );
   BuildCADModel(<span class="string">'add body'</span>, m ) ;
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="BuildF16_02.png" alt=""> <h2>This creates the connections between the bodies<a name="13"></a></h2><pre class="codeinput"><span class="comment">%------------------------------------------------</span>
BuildCADModel( <span class="string">'compute paths'</span> );
</pre><h2>Assign components to the core<a name="14"></a></h2><pre class="codeinput"><span class="comment">%------------------------------</span>
kInCore   = [5 7 9 10];
coreColor = {[0.7 0.7 0.7] [0.7 0.7 0.7] [0.7 0.7 0.7]  [0.1 0.6 0.7]};
j         = 0;
<span class="keyword">for</span> k = kInCore
  j = j + 1;
  m = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'faceColor'</span>, coreColor{j}, <span class="string">'vertex'</span>, g.component(k).v, <span class="string">'face'</span>, g.component(k).f,<span class="keyword">...</span>
                       <span class="string">'specularStrength'</span>, 1, <span class="string">'diffuseStrength'</span>, 0.3,<span class="string">'rA'</span>, [0;0;0], <span class="string">'mass'</span>, 0, <span class="string">'name'</span>, g.component(k).name, <span class="string">'body'</span>, 1 );
  BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="BuildF16_03.png" alt=""> <h2>Add in the engine<a name="15"></a></h2><pre class="codeinput"><span class="comment">%------------------</span>
m = CreateComponent( <span class="string">'make'</span>, <span class="string">'f16 gas turbine'</span>, <span class="string">'faceColor'</span>, [0.7 0.7 0.7], <span class="string">'vertex'</span>, g.component(8).v, <span class="string">'face'</span>, g.component(8).f,<span class="keyword">...</span>
                     <span class="string">'specularStrength'</span>, 1, <span class="string">'diffuseStrength'</span>, 0.3,<span class="string">'rA'</span>, [0;0;0], <span class="string">'mass'</span>, 0, <span class="string">'name'</span>, g.component(8).name, <span class="string">'body'</span>, 1,<span class="keyword">...</span>
					 <span class="string">'dataFileName'</span>, <span class="string">':Data:EngineDataFile.txt'</span>, <span class="string">'unitVector'</span>, [1;0;0] );
BuildCADModel( <span class="string">'add component'</span>, m );

<span class="comment">%--------------------------------------------------------</span>
</pre><img vspace="5" hspace="5" src="BuildF16_04.png" alt=""> <h2>Add in the control surfaces<a name="16"></a></h2><pre class="codeinput"><span class="comment">%--------------------------------------------------------</span>
</pre><h2>Rudder<a name="17"></a></h2><pre class="codeinput"><span class="comment">%-------</span>
<span class="keyword">for</span> k = kInRudder
  m = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'faceColor'</span>, [0.6 0.6 0.6],<span class="keyword">...</span>
                       <span class="string">'vertex'</span>, g.component(k).v, <span class="string">'face'</span>, g.component(k).f,<span class="keyword">...</span>
                       <span class="string">'specularStrength'</span>, 1, <span class="string">'diffuseStrength'</span>, 0.3,<span class="keyword">...</span>
                       <span class="string">'rA'</span>, [0;0;0], <span class="string">'mass'</span>, 0, <span class="string">'name'</span>, g.component(k).name,<span class="keyword">...</span>
                       <span class="string">'body'</span>, 2 );
  BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>

m = CreateComponent( <span class="string">'make'</span>, <span class="string">'single axis linear drive'</span>, <span class="string">'powerStandby'</span>, 25,<span class="keyword">...</span>
                     <span class="string">'unitVector'</span>, rudderUnitVector, <span class="string">'faceColor'</span>, [0.6 0.6 0.6],<span class="keyword">...</span>
 					           <span class="string">'rA'</span>, rRudderDrive, <span class="string">'mass'</span>, 0.5, <span class="string">'name'</span>, <span class="string">'Rudder Drive'</span>,<span class="keyword">...</span>
                     <span class="string">'body'</span>, 1, <span class="string">'drivenBody'</span>, 2, <span class="string">'inside'</span>, 1 );
BuildCADModel( <span class="string">'add component'</span>, m );
</pre><img vspace="5" hspace="5" src="BuildF16_05.png" alt=""> <h2>Ailerons<a name="18"></a></h2><pre class="codeinput"><span class="comment">%---------</span>
<span class="keyword">for</span> k = kInAileronRight
  m = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'faceColor'</span>, [0.6 0.6 0.6],<span class="keyword">...</span>
                       <span class="string">'vertex'</span>, g.component(k).v, <span class="string">'face'</span>, g.component(k).f,<span class="keyword">...</span>
                       <span class="string">'specularStrength'</span>, 1, <span class="string">'diffuseStrength'</span>, 0.3,<span class="keyword">...</span>
                       <span class="string">'rA'</span>, [0;0;0], <span class="string">'mass'</span>, 0, <span class="string">'name'</span>, g.component(k).name, <span class="string">'body'</span>, 3 );
  BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>

m = CreateComponent( <span class="string">'make'</span>, <span class="string">'single axis linear drive'</span>, <span class="string">'powerStandby'</span>, 25,<span class="keyword">...</span>
                     <span class="string">'unitVector'</span>, [0;0;1], <span class="string">'faceColor'</span>, [0.6 0.6 0.6],<span class="keyword">...</span>
 					           <span class="string">'rA'</span>, rHinge(:,3), <span class="string">'mass'</span>, 0.5, <span class="string">'name'</span>, <span class="string">'Aileron RIght Drive'</span>,<span class="keyword">...</span>
                     <span class="string">'body'</span>, 1, <span class="string">'drivenBody'</span>, 3, <span class="string">'inside'</span>, 1 );
BuildCADModel( <span class="string">'add component'</span>, m );

<span class="keyword">for</span> k = kInAileronLeft
  m = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'faceColor'</span>, [0.6 0.6 0.6],<span class="keyword">...</span>
                       <span class="string">'vertex'</span>, g.component(k).v, <span class="string">'face'</span>, g.component(k).f,<span class="keyword">...</span>
                       <span class="string">'specularStrength'</span>, 1, <span class="string">'diffuseStrength'</span>, 0.3,<span class="keyword">...</span>
                       <span class="string">'rA'</span>, [0;0;0], <span class="string">'mass'</span>, 0, <span class="string">'name'</span>, g.component(k).name, <span class="string">'body'</span>, 4 );
  BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>

m = CreateComponent( <span class="string">'make'</span>, <span class="string">'single axis linear drive'</span>, <span class="string">'powerStandby'</span>, 25,<span class="keyword">...</span>
                     <span class="string">'unitVector'</span>, [0;0;1], <span class="string">'faceColor'</span>, [0.6 0.6 0.6],<span class="keyword">...</span>
 					           <span class="string">'rA'</span>, rHinge(:,4), <span class="string">'mass'</span>, 0.5, <span class="string">'name'</span>, <span class="string">'Aileron Left Drive'</span>,<span class="keyword">...</span>
                     <span class="string">'body'</span>, 1, <span class="string">'drivenBody'</span>, 4, <span class="string">'inside'</span>, 1 );
BuildCADModel( <span class="string">'add component'</span>, m );
</pre><img vspace="5" hspace="5" src="BuildF16_06.png" alt=""> <h2>Elevator<a name="19"></a></h2><pre class="codeinput"><span class="comment">%---------</span>
<span class="keyword">for</span> k = kInElevator
  m = CreateComponent( <span class="string">'make'</span>, <span class="string">'generic'</span>, <span class="string">'faceColor'</span>, [0.6 0.6 0.6],<span class="keyword">...</span>
                       <span class="string">'vertex'</span>, g.component(k).v, <span class="string">'face'</span>, g.component(k).f,<span class="keyword">...</span>
                       <span class="string">'specularStrength'</span>, 1, <span class="string">'diffuseStrength'</span>, 0.3,<span class="keyword">...</span>
                       <span class="string">'rA'</span>, [0;0;0], <span class="string">'mass'</span>, 0, <span class="string">'name'</span>, g.component(k).name, <span class="string">'body'</span>, 5 );
  BuildCADModel( <span class="string">'add component'</span>, m );
<span class="keyword">end</span>

m = CreateComponent( <span class="string">'make'</span>, <span class="string">'single axis linear drive'</span>, <span class="string">'powerStandby'</span>, 25,<span class="keyword">...</span>
                     <span class="string">'unitVector'</span>, [0;0;1], <span class="string">'faceColor'</span>, [0.6 0.6 0.6],<span class="keyword">...</span>
 					           <span class="string">'rA'</span>, rHinge(:,5), <span class="string">'mass'</span>, 0.5, <span class="string">'name'</span>, <span class="string">'Elevator Drive'</span>,<span class="keyword">...</span>
                     <span class="string">'body'</span>, 1, <span class="string">'drivenBody'</span>, 5, <span class="string">'inside'</span>, 1 );
BuildCADModel( <span class="string">'add component'</span>, m );
</pre><img vspace="5" hspace="5" src="BuildF16_07.png" alt=""> <h2>Sensors<a name="20"></a></h2><pre class="codeinput"><span class="comment">%---------</span>
m = CreateComponent( <span class="string">'make'</span>, <span class="string">'angle of attack sensor'</span>, <span class="string">'mass'</span>, 0, <span class="string">'x'</span>,0.01, <span class="string">'y'</span>, 0.01, <span class="string">'z'</span>, 0.01, <span class="keyword">...</span>
                     <span class="string">'name'</span>, <span class="string">'Angle of Attack Sensor'</span>, <span class="string">'body'</span>, 1 );
BuildCADModel( <span class="string">'add component'</span>, m );

m = CreateComponent( <span class="string">'make'</span>, <span class="string">'rate gyro'</span>, <span class="string">'mass'</span>, 0, <span class="string">'x'</span>,0.01, <span class="string">'y'</span>, 0.01, <span class="string">'z'</span>, 0.01,<span class="keyword">...</span>
                     <span class="string">'name'</span>, <span class="string">'Rate Gyro'</span>, <span class="string">'body'</span>, 1, <span class="string">'unitvector'</span>, [0;1;0] );
BuildCADModel( <span class="string">'add component'</span>, m );
</pre><pre class="codeoutput">CreateComponent: Rate Gyro: 
	The following fields were not recognized as device properties, but have been added to your component.
	To make a device property recognized, add it to the list in the "rate gyro" case of DeviceProperties.m.
	    'unitvector'
</pre><img vspace="5" hspace="5" src="BuildF16_08.png" alt=""> <h2>Display<a name="21"></a></h2><pre class="codeinput"><span class="comment">%---------</span>
BuildCADModel(<span class="string">'show vehicle'</span>)

<span class="comment">%--------------------------------------</span>
<span class="comment">% PSS internal file version information</span>
<span class="comment">%--------------------------------------</span>
</pre><img vspace="5" hspace="5" src="BuildF16_09.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Build the F16 Model.
% Loads an OBJ file first, which may take a few minutes.
%  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%  See also BHinge, BuildCADModel, CreateBody, CreateComponent, LoadCAD, 
%  QLVLH, Constant, TesselatePolygon
%  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%%
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%   Copyright (c) 2002 Princeton Satellite Systems, Inc. All rights reserved.
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-


%% Read in the model
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
r         = 6378.165 + 10;
v         = 502;
rECI      = [r;0;0];
vECI      = [0;v;0];
qLVLH     = QLVLH( rECI, vECI );
q         = [1;0;0;0];
omega     = [0;0;0];

lengthF16	= 14.8;

%% Read in the model
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
disp('Load the OBJ file...')
g       = LoadCAD('F16dof.obj');
disp('Finished loading. Build the model...')

%% Point the nose along x and tail along z
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
b       = [1 0 0;0 0 1;0 -1 0]*[0 0 1; 0 1 0; -1 0 0];

for k = 1:length(g.component)
   g.component(k).v = (b*g.component(k).v')';
end

maxX = 0;
minX = 0;
for k = 1:length(g.component)
   maxX = max([maxX  g.component(k).v(:,1)']);
   minX = min([minX  g.component(k).v(:,1)']);
end
scale = lengthF16/(maxX - minX);

for k = 1:length(g.component)
   g.component(k).v = g.component(k).v*scale;
end

%% Convert to triangles
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
g       = TesselatePolygon( g );

%% Want metric
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
inertiaConv = Constant('slug-ft^2 to kg-m^2');
massConv    = Constant('lb force to kg');
mass        = struct( 'mass', 20500*massConv,...
                      'inertia', [9497 0 -982; 0 55814 0 ;-982 0 63100]*inertiaConv,...
                      'cM', [0;0;0] );

%% Use the CAD interface
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
BuildCADModel( 'initialize' );
BuildCADModel( 'set mass',                   mass  );
BuildCADModel( 'set name' ,                 'F16'     );
BuildCADModel( 'set units',                 'mks'     );
BuildCADModel( 'set rECI' ,                  rECI     );
BuildCADModel( 'set vECI' ,                  vECI     );
BuildCADModel( 'set qLVLH',                  qLVLH    );
BuildCADModel( 'set qECIToBody',             q        );
BuildCADModel( 'set omega',                  omega    );
BuildCADModel( 'set aerodynamic model',      'F16Aerodynamics'  );
BuildCADModel( 'set aerodynamic model file', ':Data:AeroDataFile.txt' );

% For each component, we need to find its origin and displace it so that 
% the axis of rotation is at the origin
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-

%% Create the bodies
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
bodyName = {'core' 'rudder' 'aileronRight' 'aileronLeft' 'elevator' };
axisRot  = [0 3 2 2 2];

%% Rudder
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
dZ               = 4;
dY               = max(g.component(1).v(:,2)) - min(g.component(1).v(:,2));
angle            = atan(dZ/dY);
c                = cos(angle);
s                = sin(angle);
bHinge{2}        = [c  s 0; -s  c 0; 0 0 1];
rudderUnitVector = bHinge{2}'*[0;1;0];
y                = mean(g.component(1).v(:,2));
x                = mean(g.component(1).v(:,1));
rHinge(:,2)      = [x;y;0];
rRudderDrive     = [max(g.component(1).v(:,1));min(g.component(1).v(:,2));0];
kInRudder        = 1;

for k = kInRudder
  for j = 1:3
    g.component(k).v(:,j) = g.component(k).v(:,j) - rHinge(j,2);
  end
end
g.component(1).v = (bHinge{2}'*g.component(1).v')';

%% Aileron Right
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
x                = mean(g.component(2).v(:,1));
rHinge(:,3)      = [x;0;0];
bHinge{3}        = eye(3);
kInAileronRight  = 2;
for k = kInAileronRight
  for j = 1:3
    g.component(k).v(:,j) = g.component(k).v(:,j) - rHinge(j,3);
  end
end

%% Aileron Left
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
x                = mean(g.component(3).v(:,1));
rHinge(:,4)      = [x;0;0];
bHinge{4}        = eye(3);
kInAileronLeft   = 3;
for k = kInAileronLeft
  for j = 1:3
    g.component(k).v(:,j) = g.component(k).v(:,j) - rHinge(j,4);
  end
end

%% Elevator
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
y                = mean(g.component(4).v(:,2));
x                = mean(g.component(4).v(:,1));
rHinge(:,5)      = [x;0;0];
bHinge{5}        = eye(3);
kInElevator      = [4 6];
for k = kInElevator
  for j = 1:3
    g.component(k).v(:,j) = g.component(k).v(:,j) - rHinge(j,5);
  end
end

m = CreateBody( 'make', 'name', 'Core' );
BuildCADModel( 'add body', m );

for k = 2:length(bodyName)
   m = CreateBody( 'make', 'name', bodyName{k}, 'bHinge', struct( 'b', bHinge{k}, 'axis', axisRot(k) ), 'previousBody', 1, 'rHinge', rHinge(:,k) );
   BuildCADModel('add body', m ) ;
end

%% This creates the connections between the bodies
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
BuildCADModel( 'compute paths' );

%% Assign components to the core
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
kInCore   = [5 7 9 10];
coreColor = {[0.7 0.7 0.7] [0.7 0.7 0.7] [0.7 0.7 0.7]  [0.1 0.6 0.7]};
j         = 0;
for k = kInCore
  j = j + 1;
  m = CreateComponent( 'make', 'generic', 'faceColor', coreColor{j}, 'vertex', g.component(k).v, 'face', g.component(k).f,...
                       'specularStrength', 1, 'diffuseStrength', 0.3,'rA', [0;0;0], 'mass', 0, 'name', g.component(k).name, 'body', 1 );
  BuildCADModel( 'add component', m );
end

%% Add in the engine
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
m = CreateComponent( 'make', 'f16 gas turbine', 'faceColor', [0.7 0.7 0.7], 'vertex', g.component(8).v, 'face', g.component(8).f,...
                     'specularStrength', 1, 'diffuseStrength', 0.3,'rA', [0;0;0], 'mass', 0, 'name', g.component(8).name, 'body', 1,...
					 'dataFileName', ':Data:EngineDataFile.txt', 'unitVector', [1;0;0] );
BuildCADModel( 'add component', m );

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%% Add in the control surfaces
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% Rudder
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
for k = kInRudder
  m = CreateComponent( 'make', 'generic', 'faceColor', [0.6 0.6 0.6],...
                       'vertex', g.component(k).v, 'face', g.component(k).f,...
                       'specularStrength', 1, 'diffuseStrength', 0.3,...
                       'rA', [0;0;0], 'mass', 0, 'name', g.component(k).name,...
                       'body', 2 );
  BuildCADModel( 'add component', m );
end
  
m = CreateComponent( 'make', 'single axis linear drive', 'powerStandby', 25,...
                     'unitVector', rudderUnitVector, 'faceColor', [0.6 0.6 0.6],...
 					           'rA', rRudderDrive, 'mass', 0.5, 'name', 'Rudder Drive',...
                     'body', 1, 'drivenBody', 2, 'inside', 1 );
BuildCADModel( 'add component', m );

%% Ailerons
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
for k = kInAileronRight
  m = CreateComponent( 'make', 'generic', 'faceColor', [0.6 0.6 0.6],...
                       'vertex', g.component(k).v, 'face', g.component(k).f,...
                       'specularStrength', 1, 'diffuseStrength', 0.3,...
                       'rA', [0;0;0], 'mass', 0, 'name', g.component(k).name, 'body', 3 );
  BuildCADModel( 'add component', m );
end
  
m = CreateComponent( 'make', 'single axis linear drive', 'powerStandby', 25,...
                     'unitVector', [0;0;1], 'faceColor', [0.6 0.6 0.6],...
 					           'rA', rHinge(:,3), 'mass', 0.5, 'name', 'Aileron RIght Drive',...
                     'body', 1, 'drivenBody', 3, 'inside', 1 );
BuildCADModel( 'add component', m );

for k = kInAileronLeft
  m = CreateComponent( 'make', 'generic', 'faceColor', [0.6 0.6 0.6],...
                       'vertex', g.component(k).v, 'face', g.component(k).f,...
                       'specularStrength', 1, 'diffuseStrength', 0.3,...
                       'rA', [0;0;0], 'mass', 0, 'name', g.component(k).name, 'body', 4 );
  BuildCADModel( 'add component', m );
end
  
m = CreateComponent( 'make', 'single axis linear drive', 'powerStandby', 25,...
                     'unitVector', [0;0;1], 'faceColor', [0.6 0.6 0.6],...
 					           'rA', rHinge(:,4), 'mass', 0.5, 'name', 'Aileron Left Drive',...
                     'body', 1, 'drivenBody', 4, 'inside', 1 );
BuildCADModel( 'add component', m );

%% Elevator
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
for k = kInElevator
  m = CreateComponent( 'make', 'generic', 'faceColor', [0.6 0.6 0.6],...
                       'vertex', g.component(k).v, 'face', g.component(k).f,...
                       'specularStrength', 1, 'diffuseStrength', 0.3,...
                       'rA', [0;0;0], 'mass', 0, 'name', g.component(k).name, 'body', 5 );
  BuildCADModel( 'add component', m );
end
  
m = CreateComponent( 'make', 'single axis linear drive', 'powerStandby', 25,...
                     'unitVector', [0;0;1], 'faceColor', [0.6 0.6 0.6],...
 					           'rA', rHinge(:,5), 'mass', 0.5, 'name', 'Elevator Drive',...
                     'body', 1, 'drivenBody', 5, 'inside', 1 );
BuildCADModel( 'add component', m );

%% Sensors
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
m = CreateComponent( 'make', 'angle of attack sensor', 'mass', 0, 'x',0.01, 'y', 0.01, 'z', 0.01, ...
                     'name', 'Angle of Attack Sensor', 'body', 1 );
BuildCADModel( 'add component', m );

m = CreateComponent( 'make', 'rate gyro', 'mass', 0, 'x',0.01, 'y', 0.01, 'z', 0.01,...
                     'name', 'Rate Gyro', 'body', 1, 'unitvector', [0;1;0] );
BuildCADModel( 'add component', m );

%% Display
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
BuildCADModel('show vehicle')

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% PSS internal file version information
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% $Date: 2016-03-22 13:41:05 -0400 (Tue, 22 Mar 2016) $
% $Revision: 42009 $

##### SOURCE END #####
--></body></html>