<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>Lander3D</title>
<meta name="generator" content="MATLAB 24.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-01-22">
<meta name="DC.source" content="Lander3D.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">3D lander simulation using the bilinear tangent law.</a>
</li>
<li>
<a href="#3">Simulation time parameters</a>
</li>
<li>
<a href="#4">Parameters</a>
</li>
<li>
<a href="#5">Set up the bilinear controller</a>
</li>
<li>
<a href="#6">Simulation</a>
</li>
<li>
<a href="#7">Plot the simulation results</a>
</li>
</ul>
</div>
<h2 id="1">3D lander simulation using the bilinear tangent law.</h2>
<p>The spacecraft has 3-axis thruster control. Ideal attitude pointing is assumed. An altimeter gives the altitude. The planet is assumed to be a perfect sphere. The dynamics model accounts for the changing mass of the vehicle as fuel is consumed.</p>
<p>This demo demonstrates the bilinear tangent law for descent from a circular equatorial orbit. Choose between the moon, Mars, and Enceladus, or add your own body.</p>
<p>Things to explore:</p>
<pre class="language-matlab">1. For <span class="string">the</span> <span class="string">bilinear</span> <span class="string">control</span>, vary <span class="string">the</span> <span class="string">control</span> <span class="string">acceleration</span> <span class="string">(nAccel).</span>
2. Try <span class="string">different</span> <span class="string">starting</span> <span class="string">altitudes.</span>
3. Try <span class="string">different</span> <span class="string">planets:</span> <span class="string">moon</span>, Mars, Enceladus
</pre>
<pre class="codeinput">
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">% See also: LandingControlBilinear, Inertias, RHSPointMass, RK4, Plot2D</span>
<span class="comment">%--------------------------------------------------------------------------</span>
</pre>
<pre class="codeinput">
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">%   Copyright (c) 2013-2014 Princeton Satellite Systems, Inc.</span>
<span class="comment">%   All rights reserved.</span>
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">%   Since version 2014.1</span>
<span class="comment">%--------------------------------------------------------------------------</span>
</pre>
<h2 id="3">Simulation time parameters</h2>
<pre class="codeinput">
<span class="comment">%--------------------------------------</span>
dT              = 0.25; <span class="comment">% sec</span>
</pre>
<h2 id="4">Parameters</h2>
<pre class="codeinput">
<span class="comment">%------------</span>
hStop           = 0.0005; <span class="comment">% km</span>
uE              = 320*9.806; <span class="comment">% Exhaust velocity (m/s)</span>

<span class="comment">% Select the planet or moon</span>
<span class="comment">%--------------------------</span>
body            =  <span class="string">'moon'</span>; <span class="comment">%'Moon'; %'Mars';'enceladus'</span>

<span class="comment">% Planet/moon parameters</span>
<span class="comment">%-----------------------</span>
d = struct;
<span class="keyword">switch</span> lower(body)
  <span class="keyword">case</span> <span class="string">'moon'</span>
    rPlanet             = Constant(<span class="string">'equatorial radius moon'</span>); <span class="comment">% km</span>
    muPlanet            = Constant(<span class="string">'mu moon'</span>);
    h                   = 15;  <span class="comment">% Altitude of initial orbit</span>
    tEnd                = 7*60; <span class="comment">% sec</span>
    nAccel              = 10; <span class="comment">% Engine acceleration is this multiple of gravity</span>
    massFuel            = 25;
    d.mass              = 25; <span class="comment">% kg</span>
    gainVelocity        = 2;
    velocityThreshold   = 0.001;
    vMaxFrac            = 0.2;

  <span class="keyword">case</span> <span class="string">'enceladus'</span>
    rPlanet             = 252.1; <span class="comment">% km</span>
    muPlanet            = 1.08022e20*Constant(<span class="string">'newtonian constant of gravitation'</span>)/1e9;
    h                   = 10;  <span class="comment">% Altitude of initial orbit</span>
    tEnd                = 10*60; <span class="comment">% sec</span>
    nAccel              = 8; <span class="comment">% Engine acceleration is this multiple of gravity</span>
    massFuel            = 8;
    d.mass              = 100; <span class="comment">% kg</span>
    gainVelocity        = 0.5;
    velocityThreshold   = 0.001;
    vMaxFrac            = 0.2;

  <span class="keyword">case</span> <span class="string">'mars'</span>
    rPlanet             = Constant(<span class="string">'equatorial radius mars'</span>); <span class="comment">% km</span>
    muPlanet            = Constant(<span class="string">'mu mars'</span>);
    h                   = 150; <span class="comment">% Altitude of initial orbit</span>
    nAccel              = 7; <span class="comment">% Engine acceleration is this multiple of gravity</span>
    tEnd                = 5*60; <span class="comment">% sec</span>
    massFuel            = 1000;
    d.mass              = 200; <span class="comment">% kg</span>
    gainVelocity        = 4;
    velocityThreshold   = 0.001;
    vMaxFrac            = 0.2;

<span class="keyword">end</span>

<span class="comment">% Simulation time steps</span>
<span class="comment">%----------------------</span>
nSim            = floor(tEnd/dT);

<span class="comment">% Spacecraft inertia at start</span>
<span class="comment">%----------------------------</span>
d.inertia       = Inertias( d.mass + massFuel, [1 1 1], <span class="string">'box'</span>, 1 ); <span class="comment">% kg-m^2</span>
</pre>
<h2 id="5">Set up the bilinear controller</h2>
<pre class="codeinput">
<span class="comment">%--------------------------------</span>
dBilinear = struct;
dBilinear.mu                        = muPlanet;
dBilinear.mass                      = d.mass + massFuel;
dBilinear.rP                        = rPlanet;
dBilinear.h                         = h;
dBilinear.nG                        = nAccel;
dBilinear.dT                        = dT;
dBilinear.inertia                   = d.inertia;
dBilinear.hLanding                  = 0.1; <span class="comment">% The altitude at which to switch to landing mode</span>
dBilinear.throttle                  = 1;
dBilinear.landing.gainVelocity      = gainVelocity;
dBilinear.landing.velocityThreshold = velocityThreshold;
dBilinear.landing.vMaxFrac          = vMaxFrac;
dBilinear.landing.hTouchdown        = 0.001;
dBilinear.bypassACS                 = 1;
dBilinear                           = LandingControlBilinear( <span class="string">'initialize'</span>, dBilinear );

<span class="comment">% Determine initial s/c orientation (align s/c with initial beta angle)</span>
<span class="comment">%------------------------------------------------------------------</span>
d.hLanding                          = dBilinear.hLanding;
</pre>
<pre class="codeoutput">Descent duration     107.8732 sec
</pre>
<img vspace="5" hspace="5" src="Lander3D_01.png" alt=""> <h2 id="6">Simulation</h2>
<pre class="codeinput">
<span class="comment">%------------</span>

<span class="comment">% Gravity</span>
<span class="comment">%--------</span>
d.mu    = muPlanet; <span class="comment">% km^3/s^2</span>

<span class="comment">% Disturbances</span>
<span class="comment">%-------------</span>
d.fDist = []; <span class="comment">% The landing force function</span>

<span class="comment">% State vector [r;v;mass fuel]</span>
<span class="comment">% Assume a circular orbit to start</span>
<span class="comment">%---------------------------------</span>
r = rPlanet + h;
u = sqrt(muPlanet/r);
x = [0;r;0;-u;0;0;massFuel];

<span class="comment">% Initialize state vector array for plotting</span>
<span class="comment">%-------------------------------------------</span>
xP = zeros(length(x)+3,nSim);

<span class="comment">% Initialize time</span>
<span class="comment">%----------------</span>
t = 0;

<span class="comment">% Simulate until the lander reaches the surface (within 1 mm)</span>
<span class="comment">%------------------------------------------------------------</span>
<span class="keyword">for</span> k = 1:nSim

  <span class="comment">% Sensing - determine altitude</span>
  <span class="comment">%-----------------------------</span>
  hAltimeter = Mag(x(1:3)) - rPlanet;
  massFuel   = x(7);

  <span class="comment">% Controller</span>
  <span class="comment">%-----------</span>
  dBilinear.mass       	= d.mass + massFuel;
  dBilinear.r         	= x(1:3);
  dBilinear.v          	= x(4:6);
  dBilinear.hAltimeter	= hAltimeter;
  dBilinear.t          	= t;
  dBilinear.pointingTol = 0.001;
  dBilinear            	= LandingControlBilinear(<span class="string">'update'</span>,dBilinear);
  d.forceECI           	= dBilinear.forceECI;

  <span class="comment">% Store for plotting</span>
  <span class="comment">%-------------------</span>
  xP(:,k) = [x;hAltimeter;dBilinear.throttle;dBilinear.mode];

  <span class="comment">% Stop when we reach the surface or run out of fuel</span>
  <span class="comment">%--------------------------------------------------</span>
  <span class="keyword">if</span>( dBilinear.landing.mode == 4 )
    fprintf(1,<span class="string">'Touchdown! |v| = %12.4f km/s\n'</span>,Mag(x(4:6)));
    <span class="keyword">break</span>
  <span class="keyword">end</span>

  <span class="keyword">if</span>( hAltimeter &lt;= hStop )
    fprintf(1,<span class="string">'Terminating due to hitting the ground. |v| = %12.4f km/s\n'</span>,Mag(x(4:6)));
    <span class="keyword">break</span>
  <span class="keyword">end</span>

  <span class="keyword">if</span>( massFuel  &lt;= 0 )
    fprintf(1,<span class="string">'Terminating due to running out of fuel. |v| = %12.4f km/s h = %12.4 km\n'</span>,Mag(x(4:6)),hAltimeter);
    <span class="keyword">break</span>
  <span class="keyword">end</span>

  <span class="comment">% Fuel consumption</span>
  <span class="comment">%-----------------</span>
  d.mDot = -abs(Mag(d.forceECI))/uE;

  <span class="comment">% Integrate</span>
  <span class="comment">%----------</span>
  x = RK4(@RHSPointMass,x,dT,t,d);

  <span class="comment">% Increment time</span>
  <span class="comment">%---------------</span>
  t = t + dT;
<span class="keyword">end</span>
</pre>
<pre class="codeoutput">Altitude       4.7780
Free-fall velocity       0.0878
Maximum allowed velocity       0.0176
Terminating due to running out of fuel. |v| =       0.0151 km/s h = </pre>
<h2 id="7">Plot the simulation results</h2>
<pre class="codeinput">
<span class="comment">%-----------------------------</span>
xP = xP(:,1:k);

<span class="comment">% Time label</span>
<span class="comment">%-----------</span>
[t,tL] = TimeLabl((0:(k-1))*dT);

<span class="comment">% Plot Titles</span>
<span class="comment">%------------</span>
s1 = sprintf(<span class="string">'%s Orbit State'</span>,body);
s2 = sprintf(<span class="string">'%s Velocity, Altitude, and Throttle'</span>,body);
s3 = sprintf(<span class="string">'%s Terminal Descent'</span>,body);

<span class="comment">% Plot position in ECI frame</span>
<span class="comment">%---------------------------</span>
yL = {<span class="string">'x (km)'</span>,<span class="string">'y (km)'</span>,<span class="string">'z (km)'</span>,<span class="string">'v_x (km)'</span>,<span class="string">'v_y (km)'</span>,<span class="string">'v_z (km)'</span>};
Plot2D( t, xP(  1:6,:), tL, yL, s1 )

<span class="comment">% Summary plot</span>
<span class="comment">%-------------</span>
yL = {<span class="string">'|v| (km/s)'</span> ,<span class="string">'h (km)'</span>, <span class="string">'Throttle'</span> <span class="string">'Mode'</span> , <span class="string">'Fuel Mass (kg)'</span>};
Plot2D( t, [Mag(xP(4:6,:));xP([8 9 10 7],:)], tL, yL, s2);

<span class="comment">% Velocity plot</span>
<span class="comment">%--------------</span>
uV = Unit(xP(1:3,:));
vV = Dot(uV,xP(4:6,:));
vH = Mag(xP(4:6,:) - uV.*[vV;vV;vV]);
s2 = sprintf(<span class="string">'%s Velocity Plot'</span>,body);
Plot2D( t, [vV;vH;xP(10,:)], tL, {<span class="string">'Vertical Velocity (km/s)'</span> <span class="string">'Horizontal Velocity (km/s)'</span> <span class="string">'Mode'</span>},s2)
subplot(3,1,3)
set(gca,<span class="string">'YTick'</span>,[0 1 2 3 4],<span class="string">'YTickMode'</span>,<span class="string">'manual'</span>,<span class="keyword">...</span>
  <span class="string">'YTickLabel'</span>,{<span class="string">'Bilinear'</span> <span class="string">'Vertical'</span> <span class="string">'Velocity'</span> <span class="string">'Terminal'</span> <span class="string">'Touchdown'</span>})

<span class="comment">% Generate a terminal maneuvering plot</span>
<span class="comment">%-------------------------------------</span>
kT = find(xP(10,:) &gt; 0 );
vV = vV(kT);
vH = vH(kT);
xP = xP(8:10,kT);
t  = t(kT);

Plot2D( t, [vV;vH;xP], tL, {<span class="string">'Vertical Velocity (km/s)'</span> <span class="string">'Horizontal Velocity (km/s)'</span> <span class="string">'Altitude (km)'</span> <span class="string">'Throttle'</span> <span class="string">'Mode'</span>},s3)
subplot(5,1,5)
set(gca,<span class="string">'YTick'</span>,[0 1 2 3 4],<span class="string">'YTickMode'</span>,<span class="string">'manual'</span>,<span class="keyword">...</span>
  <span class="string">'YTickLabel'</span>,{<span class="string">'Bilinear'</span> <span class="string">'Vertical'</span> <span class="string">'Velocity'</span> <span class="string">'Terminal'</span> <span class="string">'Touchdown'</span>})

<span class="comment">%--------------------------------------</span>

<span class="comment">% $Id: 5d3f118ba3c37ae4ab8336a019e01eeffe1d408a $</span>
</pre>
<img vspace="5" hspace="5" src="Lander3D_02.png" alt=""> <img vspace="5" hspace="5" src="Lander3D_03.png" alt=""> <img vspace="5" hspace="5" src="Lander3D_04.png" alt=""> <img vspace="5" hspace="5" src="Lander3D_05.png" alt=""> <p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024a</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% 3D lander simulation using the bilinear tangent law.
% The spacecraft has 3-axis thruster control. Ideal attitude pointing
% is assumed. An altimeter gives the altitude. The planet is assumed to be a
% perfect sphere. The dynamics model accounts for the changing mass of the
% vehicle as fuel is consumed.
%
% This demo demonstrates the bilinear tangent law for descent from a
% circular equatorial orbit. Choose between the moon, Mars, and Enceladus,
% or add your own body.
%
% Things to explore:
%
%   1. For the bilinear control, vary the control acceleration (nAccel).
%   2. Try different starting altitudes.
%   3. Try different planets: moon, Mars, Enceladus
%
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% See also: LandingControlBilinear, Inertias, RHSPointMass, RK4, Plot2D
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%%
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%   Copyright (c) 2013-2014 Princeton Satellite Systems, Inc.
%   All rights reserved.
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%   Since version 2014.1
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% Simulation time parameters
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
dT              = 0.25; % sec

%% Parameters
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
hStop           = 0.0005; % km
uE              = 320*9.806; % Exhaust velocity (m/s)

% Select the planet or moon
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
body            =  'moon'; %'Moon'; %'Mars';'enceladus'

% Planet/moon parameters
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
d = struct;
switch lower(body)
  case 'moon'
    rPlanet             = Constant('equatorial radius moon'); % km
    muPlanet            = Constant('mu moon');
    h                   = 15;  % Altitude of initial orbit
    tEnd                = 7*60; % sec
    nAccel              = 10; % Engine acceleration is this multiple of gravity
    massFuel            = 25;
    d.mass              = 25; % kg
    gainVelocity        = 2;
    velocityThreshold   = 0.001;
    vMaxFrac            = 0.2;
    
  case 'enceladus'
    rPlanet             = 252.1; % km
    muPlanet            = 1.08022e20*Constant('newtonian constant of gravitation')/1e9;
    h                   = 10;  % Altitude of initial orbit
    tEnd                = 10*60; % sec
    nAccel              = 8; % Engine acceleration is this multiple of gravity
    massFuel            = 8;
    d.mass              = 100; % kg
    gainVelocity        = 0.5;
    velocityThreshold   = 0.001;
    vMaxFrac            = 0.2;
    
  case 'mars'
    rPlanet             = Constant('equatorial radius mars'); % km
    muPlanet            = Constant('mu mars');
    h                   = 150; % Altitude of initial orbit
    nAccel              = 7; % Engine acceleration is this multiple of gravity
    tEnd                = 5*60; % sec
    massFuel            = 1000;
    d.mass              = 200; % kg
    gainVelocity        = 4;
    velocityThreshold   = 0.001;
    vMaxFrac            = 0.2;
    
end

% Simulation time steps
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
nSim            = floor(tEnd/dT);

% Spacecraft inertia at start
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
d.inertia       = Inertias( d.mass + massFuel, [1 1 1], 'box', 1 ); % kg-m^2

%% Set up the bilinear controller
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
dBilinear = struct;
dBilinear.mu                        = muPlanet;
dBilinear.mass                      = d.mass + massFuel;
dBilinear.rP                        = rPlanet;
dBilinear.h                         = h;
dBilinear.nG                        = nAccel;
dBilinear.dT                        = dT;
dBilinear.inertia                   = d.inertia;
dBilinear.hLanding                  = 0.1; % The altitude at which to switch to landing mode
dBilinear.throttle                  = 1;
dBilinear.landing.gainVelocity      = gainVelocity;
dBilinear.landing.velocityThreshold = velocityThreshold;
dBilinear.landing.vMaxFrac          = vMaxFrac;
dBilinear.landing.hTouchdown        = 0.001;
dBilinear.bypassACS                 = 1;
dBilinear                           = LandingControlBilinear( 'initialize', dBilinear );

% Determine initial s/c orientation (align s/c with initial beta angle)
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
d.hLanding                          = dBilinear.hLanding;

%% Simulation
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

% Gravity
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
d.mu    = muPlanet; % km^3/s^2

% Disturbances
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
d.fDist = []; % The landing force function

% State vector [r;v;mass fuel]
% Assume a circular orbit to start
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
r = rPlanet + h;
u = sqrt(muPlanet/r);
x = [0;r;0;-u;0;0;massFuel];

% Initialize state vector array for plotting
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
xP = zeros(length(x)+3,nSim);

% Initialize time
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
t = 0;

% Simulate until the lander reaches the surface (within 1 mm)
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
for k = 1:nSim
  
  % Sensing - determine altitude
  %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
  hAltimeter = Mag(x(1:3)) - rPlanet;
  massFuel   = x(7);
  
  % Controller
  %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
  dBilinear.mass       	= d.mass + massFuel;
  dBilinear.r         	= x(1:3);
  dBilinear.v          	= x(4:6);
  dBilinear.hAltimeter	= hAltimeter;
  dBilinear.t          	= t;
  dBilinear.pointingTol = 0.001;
  dBilinear            	= LandingControlBilinear('update',dBilinear);
  d.forceECI           	= dBilinear.forceECI;
  
  % Store for plotting
  %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
  xP(:,k) = [x;hAltimeter;dBilinear.throttle;dBilinear.mode];
  
  % Stop when we reach the surface or run out of fuel
  %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
  if( dBilinear.landing.mode == 4 )
    fprintf(1,'Touchdown! |v| = %12.4f km/s\n',Mag(x(4:6)));
    break
  end
  
  if( hAltimeter <= hStop )
    fprintf(1,'Terminating due to hitting the ground. |v| = %12.4f km/s\n',Mag(x(4:6)));
    break
  end
  
  if( massFuel  <= 0 )
    fprintf(1,'Terminating due to running out of fuel. |v| = %12.4f km/s h = %12.4 km\n',Mag(x(4:6)),hAltimeter);
    break
  end
  
  % Fuel consumption
  %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
  d.mDot = -abs(Mag(d.forceECI))/uE;
  
  % Integrate
  %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
  x = RK4(@RHSPointMass,x,dT,t,d);
  
  % Increment time
  %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
  t = t + dT;
end


%% Plot the simulation results
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
xP = xP(:,1:k);

% Time label
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
[t,tL] = TimeLabl((0:(k-1))*dT);

% Plot Titles
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
s1 = sprintf('%s Orbit State',body);
s2 = sprintf('%s Velocity, Altitude, and Throttle',body);
s3 = sprintf('%s Terminal Descent',body);

% Plot position in ECI frame
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
yL = {'x (km)','y (km)','z (km)','v_x (km)','v_y (km)','v_z (km)'};
Plot2D( t, xP(  1:6,:), tL, yL, s1 )

% Summary plot
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
yL = {'|v| (km/s)' ,'h (km)', 'Throttle' 'Mode' , 'Fuel Mass (kg)'};
Plot2D( t, [Mag(xP(4:6,:));xP([8 9 10 7],:)], tL, yL, s2);

% Velocity plot
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
uV = Unit(xP(1:3,:));
vV = Dot(uV,xP(4:6,:));
vH = Mag(xP(4:6,:) - uV.*[vV;vV;vV]);
s2 = sprintf('%s Velocity Plot',body);
Plot2D( t, [vV;vH;xP(10,:)], tL, {'Vertical Velocity (km/s)' 'Horizontal Velocity (km/s)' 'Mode'},s2)
subplot(3,1,3)
set(gca,'YTick',[0 1 2 3 4],'YTickMode','manual',...
  'YTickLabel',{'Bilinear' 'Vertical' 'Velocity' 'Terminal' 'Touchdown'})

% Generate a terminal maneuvering plot
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
kT = find(xP(10,:) > 0 );
vV = vV(kT);
vH = vH(kT);
xP = xP(8:10,kT);
t  = t(kT);

Plot2D( t, [vV;vH;xP], tL, {'Vertical Velocity (km/s)' 'Horizontal Velocity (km/s)' 'Altitude (km)' 'Throttle' 'Mode'},s3)
subplot(5,1,5)
set(gca,'YTick',[0 1 2 3 4],'YTickMode','manual',...
  'YTickLabel',{'Bilinear' 'Vertical' 'Velocity' 'Terminal' 'Touchdown'})

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% $Date:   Lander3D.m $
% $Id: 5d3f118ba3c37ae4ab8336a019e01eeffe1d408a $

##### SOURCE END #####
-->
</body>
</html>
